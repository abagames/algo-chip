(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();const Rt={simple:[["C","G","Am","F"],["C","Em","F","G"],["Am","F","C","G"],["C","Am","Dm","G"],["C","F","G","C"]],town_peaceful:[["C","F","C","G"],["C","G","Em","Am"],["F","G","Em","Am"],["C","F","Am","G"],["C","G","F","C"]],heroic_fanfare:[["C","Am","F","G"],["C","G","Am","Em"],["F","C","G","Am"],["C","Dm","G","C"],["Am","F","G","C"]],playful:[["C","F","G","Am"],["C","Em","Am","F"],["F","G","C","Am"],["C","G","F","Em"],["Am","G","F","C"]]},xt={castle_majestic:[["Em","C","G","D"],["Em","B7","Em","C"],["C","G","D","Em"],["Em","C","D","G"],["Em","Em","C","D"]],dark:[["Em","D","C","B7"],["Em","C","Am","B7"],["Em","Bm","C","G"],["Em","C","D","Bm"],["Em","G","F","B7"]],ending_sorrowful:[["Em","C","G","D"],["Em","Bm","C","G"],["Em","D","C","B7"],["Em","G","D","C"],["Em","C","Am","B7"]],final_battle_tense:[["Em","C","D","B7"],["Em","G","D","Em"],["C","D","Em","Em"],["Em","Bm","C","D"],["G","D","Em","C"]],mysterious:[["Em","Am","F","C"],["Am","Em","G","C"],["Em","F","G","Em"],["Dm","Am","G","C"],["Em","C","Am","Bm"]],epic_adventure:[["Em","C","G","D"],["G","Em","C","D"],["C","G","Am","Em"],["Em","D","C","G"],["Am","Em","G","D"]]},Pt={heroic:[["G","C","D","G"],["G","Em","C","D"],["C","D","G","G"],["G","B7","Em","C"],["Em","C","G","D"]],overworld_bright:[["G","D","Em","C"],["C","G","D","G"],["G","Em","Am","D"],["G","C","D","G"],["G","B7","Em","C"]],triumph:[["G","D","C","G"],["C","D","G","Em"],["G","C","Am","D"],["Em","C","D","G"],["G","D","Em","D"]],adventure:[["G","Em","C","D"],["Am","D","G","C"],["G","C","D","Em"],["C","Am","G","D"],["G","D","C","Am"]]},Et={C_Major:Rt,E_Minor:xt,G_Major:Pt},st=Et,Bt={slow:90,medium:120,fast:150},Tt={upbeat:["overworld_bright","heroic"],sad:["ending_sorrowful","dark"],tense:["final_battle_tense","castle_majestic"],peaceful:["town_peaceful","simple"]},Ht={upbeat:"G_Major",sad:"E_Minor",tense:"E_Minor",peaceful:"C_Major"},Y=Object.keys(st),It={G_Major:[0,2,4,5,7,9,11],E_Minor:[0,2,3,5,7,8,10],C_Major:[0,2,4,5,7,9,11]},ke=[[{id:"Intro",measures:1},{id:"A",measures:3},{id:"B",measures:2},{id:"A",measures:2}],[{id:"A",measures:2},{id:"B",measures:2},{id:"A",measures:2},{id:"C",measures:2}],[{id:"Intro",measures:2},{id:"A",measures:2},{id:"Bridge",measures:2},{id:"A",measures:2}],[{id:"A",measures:4},{id:"B",measures:2},{id:"C",measures:2}]],Kt={tense:[0,3],upbeat:[1,2],sad:[2,3],peaceful:[1,2]},De={16:{upbeat:[{id:"A",measures:8},{id:"B",measures:8}],peaceful:[{id:"A",measures:8},{id:"B",measures:8}],tense:[{id:"A",measures:8},{id:"B",measures:8}],sad:[{id:"A",measures:8},{id:"B",measures:8}]},32:{upbeat:[{id:"A",measures:8},{id:"B",measures:8},{id:"C",measures:8},{id:"D",measures:8}],peaceful:[{id:"A",measures:16},{id:"B",measures:16}],tense:[{id:"A",measures:8},{id:"B",measures:8},{id:"A",measures:8},{id:"C",measures:8}],sad:[{id:"Intro",measures:4},{id:"A",measures:12},{id:"B",measures:8},{id:"A",measures:8}]},64:{upbeat:[{id:"A",measures:16},{id:"B",measures:16},{id:"C",measures:16},{id:"D",measures:16}],peaceful:[{id:"A",measures:16},{id:"B",measures:16},{id:"A",measures:16},{id:"C",measures:16}],tense:[{id:"Intro",measures:8},{id:"A",measures:16},{id:"B",measures:16},{id:"C",measures:12},{id:"A",measures:12}],sad:[{id:"Intro",measures:8},{id:"A",measures:20},{id:"B",measures:16},{id:"A",measures:20}]}},rt=new Set(["A"]),me="steady",Ot=1,At={textureFocus:!1,loopCentric:!1,gradualBuild:!1,harmonicStatic:!1,percussiveLayering:!1,breakInsertion:!1,filterMotion:!1,syncopationBias:!1,atmosPad:!1},it={minimalTechno:{textureFocus:!0,loopCentric:!0,harmonicStatic:!0,percussiveLayering:!0,filterMotion:!0,syncopationBias:!0},progressiveHouse:{textureFocus:!0,loopCentric:!0,gradualBuild:!0,percussiveLayering:!0,breakInsertion:!0,filterMotion:!0,atmosPad:!0},retroLoopwave:{textureFocus:!0,loopCentric:!0,percussiveLayering:!0,filterMotion:!0,syncopationBias:!0},breakbeatJungle:{textureFocus:!0,percussiveLayering:!0,breakInsertion:!0,filterMotion:!0,syncopationBias:!0},lofiChillhop:{loopCentric:!0,harmonicStatic:!0,atmosPad:!0,textureFocus:!0}};function Ft(){return{...At}}function Ce(a,e){if(!e)return a;const t={...a};for(const n of Object.keys(a))e[n]!==void 0&&(t[n]=!!e[n]);return t}function kt(a){let e={};if(a.stylePreset){const t=it[a.stylePreset];t&&(e={...e,...t})}return a.styleOverrides&&(e={...e,...a.styleOverrides}),e}function Dt(a,e){let t=Ft();if(a.stylePreset){const h=it[a.stylePreset];h&&(t=Ce(t,h))}const n=e.reduce((h,g)=>h+g.measures,0),s=e.reduce((h,g)=>(h.set(g.templateId,(h.get(g.templateId)??0)+1),h),new Map),r=Array.from(s.values()).some(h=>h>=2),i=e.length?n/e.length:n;(r||i<=4)&&(t.loopCentric=!0),a.tempo!=="slow"&&n>=8&&(t.loopCentric=!0,t.percussiveLayering=!0),(a.mood==="tense"||a.mood==="sad")&&(t.textureFocus=!0),a.mood==="peaceful"&&(t.atmosPad=!0),(a.mood==="upbeat"||a.mood==="tense")&&(t.syncopationBias=!0),a.tempo==="fast"&&(t.filterMotion=!0,t.percussiveLayering=!0),n>=12&&(t.gradualBuild=!0);const o=new Set,l=new Set;let u=0;for(const h of e)h.chordProgression.forEach(g=>o.add(g)),l.add(h.chordProgression.join("|")),new Set(h.chordProgression).size<=1&&u++;const p=e.length>0&&u===e.length;l.size<=1&&(o.size<=2||p)&&(t.harmonicStatic=!0),n>=8&&a.tempo!=="slow"&&(t.breakInsertion=!0);const d=t.harmonicStatic;t=Ce(t,a.styleOverrides);const c=a.styleOverrides&&typeof a.styleOverrides.harmonicStatic=="boolean";return!d&&!c&&(t.harmonicStatic=!1),t}function O(a,e){const t=Math.imul(a??0,1664525)+Math.imul(e,1013904223)>>>0;return(Math.imul(t,22695477)+1>>>0)/4294967295}function Ct(a,e,t){const n=st[a];if(!n)throw new Error(`No chord motifs for key ${a}`);const s=[];for(const i of e)Array.isArray(n[i])&&s.push(...n[i]);const r=s.length?s:Object.values(n).flat();if(!r.length)throw new Error(`No chord progressions available for key ${a}`);return ot(r,t,100).map(i=>[...i])}function we(a,e){const t=a.match(/^([A-G])(#|b)?(.*)$/);if(!t)return a;const[,n,s="",r]=t,i=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],o={C:0,"C#":1,Db:1,D:2,"D#":3,Eb:3,E:4,F:5,"F#":6,Gb:6,G:7,"G#":8,Ab:8,A:9,"A#":10,Bb:10,B:11},l=n+s,u=o[l];if(u===void 0)return a;const p=(u+e+12)%12;return i[p]+r}function wt(a){const e=a.match(/^([A-G](?:#|b)?)(m?)(.*)$/);if(!e)return a;const[,t,n,s]=e;return n==="m"?t+s:t+"m"+s}function Lt(a){const e=[];return e.push(we(a,7)),e.push(we(a,5)),e.push(wt(a)),e}function Nt(a,e){const t=3+Math.floor(e()*2),n=Array(t).fill(a);if(e()<.2){const s=Lt(a),r=s[Math.floor(e()*s.length)];n.push(r)}return n}function Gt(a,e,t,n){const s=a.lengthInMeasures;let r;s in De?r=De[s][a.mood].map(f=>({...f})):r=ea(a.mood,t);const i=r.reduce((f,y)=>f+y.measures,0);let o=[];if(s===i)o=r;else if(s>i){const f=Math.floor(s/i);for(let x=0;x<f;x++)o=o.concat(r);let y=s-f*i,b=0;for(;y>0;){const x=r[b%r.length],F=Math.min(x.measures,y);o.push({id:x.id,measures:F}),y-=F,b++}}else{let f=0;for(const y of r){if(f+y.measures>s){const b=Math.max(s-f,0);b>0&&o.push({id:y.id,measures:b});break}o.push(y),f+=y.measures}}const l=[];let u=0,p=0;const d=ot(e,t,200+p),c=new Map,h=new Set;for(const f of d)f.forEach(y=>h.add(y));const g=(f=>{let y=(f??987654321)>>>0;return y===0&&(y=987654321),()=>(y=y*1664525+1013904223>>>0,y/4294967295)})(t),v=n.harmonicStatic===!0,m=v&&h.size<=1;for(const f of o){let y;if(m&&d.length>0)y=[d[0][0]];else if(v&&d.length>0){const R=d[p%d.length][0];y=Nt(R,g)}else y=d[p%d.length];const b=f.id,x=(c.get(b)??0)+1;c.set(b,x);const F=Wt(b,x,t);l.push({id:`${f.id}${l.filter(R=>R.id.startsWith(f.id)).length+1}`,startMeasure:u,measures:f.measures,chordProgression:y,templateId:b,occurrenceIndex:x,texture:F}),u+=f.measures,m||p++}return l}const qt={Intro:["broken"],A:["broken","steady","broken"],B:["steady","steady","arpeggio"],Bridge:["arpeggio","steady"],C:["steady","arpeggio","steady"]},Ut={Intro:1,A:2,B:2,Bridge:4,C:2},Le={firstOccurrence:.7,repeatOccurrence:.4},Vt=.1;function Wt(a,e,t){const n=qt[a]??[me],s=n[(e-1)%n.length]??me;if(s==="arpeggio"){const i=e===1,o=a.split("").reduce((p,d)=>p+d.charCodeAt(0),0),l=O(t,1e3+o*7+e*13),u=i?Le.firstOccurrence:Le.repeatOccurrence;if(l>u)return n.find(p=>p!=="arpeggio")??me}const r=a.charCodeAt(0)*100+e;if(O(t,2e3+r)<Vt){const i=["steady","broken","arpeggio"].filter(l=>l!==s),o=Math.floor(O(t,3e3+r)*i.length);return i[o]??s}return s}function jt(a){return Ut[a]??Ot}function $t(a){return jt(a.templateId)}function ue(a){return a.occurrenceIndex===1&&rt.has(a.templateId)}function k(a){return a.occurrenceIndex>1&&rt.has(a.templateId)}function zt(a,e,t){let n,s=50;switch(a){case"tense":n={echoProbability:.5,detuneProbability:.3,fastArpeggioProbability:.4},s=10;break;case"upbeat":n={echoProbability:.4,detuneProbability:.2,fastArpeggioProbability:.2},s=20;break;case"sad":n={echoProbability:.6,detuneProbability:.1,fastArpeggioProbability:.1},s=30;break;case"peaceful":n={echoProbability:.5,detuneProbability:.05,fastArpeggioProbability:.05},s=40;break;default:n={echoProbability:.3,detuneProbability:.3,fastArpeggioProbability:.3};break}const r=Jt(n,e);return Yt(r,t,s)}function Yt(a,e,t){const n=r=>Math.min(.95,Math.max(.05,r)),s=r=>(O(e,t+r)-.5)*.2;return{echoProbability:n(a.echoProbability+s(1)),detuneProbability:n(a.detuneProbability+s(2)),fastArpeggioProbability:n(a.fastArpeggioProbability+s(3))}}function Jt(a,e){const t={...a};return e.textureFocus&&(t.fastArpeggioProbability=Math.max(.05,t.fastArpeggioProbability*.6),t.echoProbability=Math.min(.95,t.echoProbability+.05)),e.loopCentric&&(t.detuneProbability=Math.max(.05,t.detuneProbability*.8)),e.gradualBuild&&(t.echoProbability=Math.min(.95,t.echoProbability+.1)),e.harmonicStatic&&(t.detuneProbability=Math.max(.05,t.detuneProbability*.7)),e.percussiveLayering&&(t.fastArpeggioProbability=Math.min(.9,t.fastArpeggioProbability+.05)),e.filterMotion&&(t.detuneProbability=Math.min(.9,t.detuneProbability+.1)),e.syncopationBias&&(t.echoProbability=Math.min(.9,t.echoProbability+.05)),e.atmosPad&&(t.echoProbability=Math.min(.95,t.echoProbability+.08)),e.breakInsertion&&(t.fastArpeggioProbability=Math.max(.05,t.fastArpeggioProbability*.9)),t}const Ne={standard:{id:"standard",description:"Classic melody + accompaniment + bass",voices:[{role:"melody",channel:"square1",priority:1,octaveOffset:0},{role:"accompaniment",channel:"square2",priority:1,octaveOffset:0},{role:"bass",channel:"triangle",priority:1,octaveOffset:0}]},swapped:{id:"swapped",description:"Swapped square channels for tonal variety",voices:[{role:"melody",channel:"square2",priority:1,octaveOffset:0},{role:"accompaniment",channel:"square1",priority:1,octaveOffset:0},{role:"bass",channel:"triangle",priority:1,octaveOffset:0}]},dualBass:{id:"dualBass",description:"Melody with dual bass (thick low end)",voices:[{role:"melody",channel:"square1",priority:1,octaveOffset:0},{role:"bass",channel:"square2",priority:1,octaveOffset:0,seedOffset:0},{role:"bassAlt",channel:"triangle",priority:.7,octaveOffset:-1,seedOffset:100}]},bassLed:{id:"bassLed",description:"Bass-focused with sparse melodic decoration",voices:[{role:"bass",channel:"triangle",priority:1,octaveOffset:-1,seedOffset:0},{role:"bassAlt",channel:"square2",priority:.8,octaveOffset:0,seedOffset:200},{role:"melody",channel:"square1",priority:.3,octaveOffset:0}]},layeredBass:{id:"layeredBass",description:"Layered bass with complementary square/triangle movement",voices:[{role:"bass",channel:"square1",priority:1,octaveOffset:0,seedOffset:0},{role:"bassAlt",channel:"triangle",priority:.85,octaveOffset:0,seedOffset:160},{role:"melody",channel:"square2",priority:1,octaveOffset:0}]},minimal:{id:"minimal",description:"Minimal techno: bass + sparse pad only",voices:[{role:"bass",channel:"square1",priority:1,octaveOffset:0},{role:"pad",channel:"triangle",priority:.4,octaveOffset:0}]},breakLayered:{id:"breakLayered",description:"Breakbeat layering: dual bass pressure with agile lead",voices:[{role:"bass",channel:"square1",priority:1,octaveOffset:0,seedOffset:0},{role:"bassAlt",channel:"triangle",priority:.95,octaveOffset:-1,seedOffset:140},{role:"melody",channel:"square2",priority:.85,octaveOffset:0,seedOffset:240}]},lofiPadLead:{id:"lofiPadLead",description:"Lo-fi pad-first texture with gentle lead flourishes",voices:[{role:"pad",channel:"triangle",priority:.9,octaveOffset:-1},{role:"accompaniment",channel:"square2",priority:1,octaveOffset:-1,seedOffset:60},{role:"melody",channel:"square1",priority:.45,octaveOffset:0,seedOffset:180}]},retroPulse:{id:"retroPulse",description:"Retro loopwave pulse arpeggios with anchored bass",voices:[{role:"melody",channel:"square1",priority:1,octaveOffset:0,seedOffset:80},{role:"accompaniment",channel:"square2",priority:.85,octaveOffset:0,seedOffset:140},{role:"bass",channel:"triangle",priority:.9,octaveOffset:-1,seedOffset:40}]}},Xt={minimalTechno:{standard:2,minimal:5,bassLed:3,dualBass:2,swapped:1,layeredBass:1},progressiveHouse:{standard:4,swapped:3,layeredBass:3,dualBass:2,bassLed:1,minimal:0},retroLoopwave:{standard:2,swapped:3,retroPulse:5,layeredBass:1,minimal:0,bassLed:1},breakbeatJungle:{breakLayered:5,dualBass:3,layeredBass:2,bassLed:2,standard:1,swapped:1,minimal:0},lofiChillhop:{lofiPadLead:5,minimal:3,standard:2,swapped:1,bassLed:1,layeredBass:0,dualBass:1}},Ge={standard:5,swapped:4,dualBass:2,bassLed:2,layeredBass:2,minimal:1,breakLayered:1,lofiPadLead:1,retroPulse:2};function Qt(a,e){const t=e?{...Ge,...Xt[e]}:Ge,n=Object.entries(t),s=n.reduce((o,[,l])=>o+l,0),r=O(a,100);let i=0;for(const[o,l]of n)if(i+=l/s,r<i)return Ne[o];return Ne.standard}function Zt(a){const e=Bt[a.tempo],t=Math.round((O(a.seed,1)-.5)*30),n=e+Math.max(-15,Math.min(15,t)),s=Tt[a.mood],r=ta(a.mood,a.seed),i=It[r];if(!i)throw new Error(`Scale not defined for key ${r}`);const o=Ct(r,s,a.seed),l=kt(a),u=Gt(a,o,a.seed,l),p=Dt(a,u),d=zt(a.mood,p,a.seed);aa(a.lengthInMeasures,u);const c=Qt(a.seed,a.stylePreset);return{bpm:n,key:r,scaleDegrees:i,sections:u,techniqueStrategy:d,styleIntent:p,voiceArrangement:c}}function ea(a,e){const t=Kt[a]??ke.map((s,r)=>r),n=t[Math.floor(O(e,60)*t.length)]??0;return ke[n].map(s=>({...s}))}function ot(a,e,t){const n=[...a];for(let s=n.length-1;s>0;s--){const r=Math.floor(O(e,t+s)*(s+1)),i=n[s];n[s]=n[r],n[r]=i}return n}function ta(a,e){const t=Ht[a];if(t&&Y.includes(t))return t;if(!Y.length)throw new Error("Chord library is empty");const n=Math.floor(O(e,5)*Y.length)%Y.length;return Y[n]}function aa(a,e){const t=e.reduce((n,s)=>n+s.measures,0);if(t!==a)throw new Error(`Section length mismatch. expected=${a}, actual=${t}`)}const na={K:.25,S:.25,H:.125,O:.375,T:.5,N:.375},sa={C:0,"C#":1,Db:1,D:2,"D#":3,Eb:3,E:4,F:5,"F#":6,Gb:6,G:7,"G#":8,Ab:8,A:9,"A#":10,Bb:10,B:11},te={"":[0,4,7],m:[0,3,7],7:[0,4,7,10],m7:[0,3,7,10],maj7:[0,4,7,11],sus2:[0,2,7],sus4:[0,5,7],dim:[0,3,6],aug:[0,4,8]},_=4;function de(a,e){const t=a.match(/^[A-G](#|b)?/i);if(!t)return e;const n=t[0].toUpperCase(),s=sa[n]??0;return e-e%12+s}function Re(a){const e=a.match(/^[A-G](?:#|b)?(.*)$/),t=(e==null?void 0:e[1])??"";return t in te?te[t]:t.startsWith("m")?te.m:te[""]}function ce(a,e,t,n=0){const s=((a-1)%e.length+e.length)%e.length,r=Math.floor((a-1)/e.length)+n,i=e[s]+12*r;return t+i}function lt(a,e,t){const n=[];for(let s=0;s<a.length;s++){const r=a[s];if(r==="-")continue;const i=e+s/16*_;n.push({startBeat:i,durationBeats:na[r]??.25,instrument:r,sectionId:t})}return n}function I(a,e,t=_){const n=Math.floor(e/t),s=a.sections.find(i=>n>=i.startMeasure&&n<i.startMeasure+i.measures);if(!s){const i=a.sections[0];return(i==null?void 0:i.chordProgression[0])??"C"}const r=Math.max(0,n-s.startMeasure);return s.chordProgression[r%s.chordProgression.length]}function ra(a){return 12*Math.log2(a)}function ia(a){return 440*Math.pow(2,(a-69)/12)}function oa(a){return(a%12+12)%12}function B(a,e){const t=de(e,a),n=Re(e);let s=a,r=1/0;for(const i of n)for(let o=-2;o<=2;o++){const l=t+i+o*12,u=Math.abs(l-a);u<r&&(s=l,r=u)}return s}const la=new Set([0,3,4,5,7,8,9]);function Q(a,e,t){if(t===void 0)return B(a,e);const n=de(e,t),s=Re(e);let r=a,i=Number.POSITIVE_INFINITY;for(const o of s)for(let l=-2;l<=2;l++){const u=n+o+l*12,p=oa(u-t),d=la.has(p)?0:10,c=Math.abs(u-a)*.1,h=Math.abs(u-t)*.05,g=d+c+h;g<i&&(i=g,r=u)}return r}const qe={MIN:20,MAX_ACCENT:118},J={TRIANGLE_BASE:.75,TRIANGLE_NON_BASS:.9,BASS_BASE:.7,BASS_LOW_RANGE:.85,SQUARE_BASS:.82},ua={BASS_LOW_RANGE:52},Ue={broken:74,steady:70,arpeggio:76,default:72},Ve={DOWNBEAT_BOOST:6,STRONG_BEAT_BOOST:3},da={PICKUP_BASE:72},A={EARLY_START:52,PAD_MIN:48,ARPEGGIO_SCALE:.75,BROKEN_SCALE:.9,STEADY_SCALE:.85},We={ECHO_SCALE:.6,DETUNE_SCALE:.7},G={KICK:120,TOM:116,LOW_NOISE:112,SNARE:115,HIHAT:118,OPEN_HAT:114},ca=[{id:"RM001",length:4,pattern:[4,4,4,4],tags:["start","straight","loop_safe","loop_safe"],variations:["RM002","RM003"]},{id:"RM002",length:4,pattern:[4,8,8,4,4],tags:["start","straight","loop_safe","kick"],variations:["RM003","RM004"]},{id:"RM003",length:4,pattern:[8,8,8,8,4,4],tags:["start","straight","loop_safe","sfx_long"],variations:["RM004","RM005"]},{id:"RM004",length:4,pattern:[4,8,8,4,4],tags:["start","straight","loop_safe"],variations:["RM005","RM006"]},{id:"RM005",length:4,pattern:[8,8,4,8,8,4],tags:["start","straight","loop_safe"],variations:["RM006","RM007"]},{id:"RM006",length:4,pattern:[8,8,4,8,8,4],tags:["start","syncopation","loop_safe","anacrusis"],variations:["RM007","RM008"]},{id:"RM007",length:4,pattern:[8,16,16,8,16,16,4,4],tags:["start","syncopation","loop_safe","anacrusis"],variations:["RM008","RM027"]},{id:"RM008",length:4,pattern:[4,8,8,4,8,8],tags:["start","syncopation","loop_safe","anacrusis"],variations:["RM027","RM028"]},{id:"RM009",length:4,pattern:[8,8,4,8,8,4],tags:["middle","straight","bridge"],variations:["RM010","RM011"]},{id:"RM010",length:4,pattern:[4,4,8,8,4],tags:["middle","straight","bridge"],variations:["RM011","RM012"]},{id:"RM011",length:4,pattern:[4,4,4,8,8],tags:["middle","straight","bridge"],variations:["RM012","RM013"]},{id:"RM012",length:8,pattern:[8,8,4,4,8,8,4,4,4,4],tags:["middle","syncopation","bridge"],variations:["RM013","RM014"]},{id:"RM013",length:8,pattern:[4,8,8,4,8,8,4,4,4,4],tags:["middle","syncopation","bridge"],variations:["RM014","RM015"]},{id:"RM014",length:8,pattern:[8,8,8,8,4,4,4,4,4,4],tags:["middle","syncopation","bridge"],variations:["RM015","RM016"]},{id:"RM015",length:8,pattern:[4,4,4,4,4,4,4,4],tags:["middle","sustain","open"],variations:["RM016","RM017"]},{id:"RM016",length:8,pattern:[4,8,8,4,4,4,8,8,4,4],tags:["middle","sustain","open"],variations:["RM017","RM018"]},{id:"RM017",length:4,pattern:[8,16,16,8,16,16,8,16,16,4],tags:["middle","swing_hint","bridge"],variations:["RM018","RM029"]},{id:"RM018",length:4,pattern:[8,16,16,4,8,16,16,4],tags:["middle","swing_hint","bridge"],variations:["RM029","RM030"]},{id:"RM019",length:4,pattern:[4,4,4,4],tags:["end","straight","loop_safe"],variations:["RM020","RM021"]},{id:"RM020",length:4,pattern:[8,8,4,8,8,4],tags:["end","straight","loop_safe"],variations:["RM021","RM022"]},{id:"RM021",length:4,pattern:[4,8,8,4,4],tags:["end","straight","loop_safe"],variations:["RM022","RM023"]},{id:"RM022",length:4,pattern:[4,4,4,4],tags:["end","cadence"],variations:["RM023","RM024"]},{id:"RM023",length:4,pattern:[8,8,4,4,4],tags:["end","cadence"],variations:["RM024","RM025"]},{id:"RM024",length:4,pattern:[4,8,8,4,4],tags:["end","cadence"],variations:["RM025","RM026"]},{id:"RM025",length:8,pattern:[4,4,4,4,4,4,4,4],tags:["end","cadence","loop_safe"],variations:["RM026","RM019"]},{id:"RM026",length:8,pattern:[8,8,4,4,4,8,8,4,4,4],tags:["end","cadence","loop_safe"],variations:["RM019","RM020"]},{id:"RM027",length:4,pattern:[8,8,8,8,8,8,4],tags:["start","staccato","anacrusis"],variations:["RM028","RM001"]},{id:"RM028",length:4,pattern:[8,8,8,8,4,8,8],tags:["start","staccato","anacrusis"],variations:["RM001","RM002"]},{id:"RM029",length:8,pattern:[8,8,4,8,8,4,8,8,4,4,4],tags:["middle","syncopation","bridge","loop_safe"],variations:["RM030","RM031"]},{id:"RM030",length:8,pattern:[8,8,4,8,8,4,8,8,4,4,4],tags:["middle","syncopation","bridge","loop_safe"],variations:["RM031","RM032"]},{id:"RM031",length:8,pattern:[8,8,4,8,8,4,8,8,4,4,4],tags:["middle","syncopation","bridge","loop_safe"],variations:["RM032","RM033"]},{id:"RM032",length:8,pattern:[8,8,4,8,8,4,8,8,4,4,4],tags:["middle","syncopation","bridge","loop_safe"],variations:["RM033","RM034"]},{id:"RM033",length:8,pattern:[8,8,4,8,8,4,8,8,4,4,4],tags:["middle","syncopation","bridge","loop_safe"],variations:["RM034","RM035"]},{id:"RM034",length:8,pattern:[8,8,4,8,8,4,8,8,4,4,4],tags:["middle","syncopation","bridge","loop_safe"],variations:["RM035","RM036"]},{id:"RM035",length:8,pattern:[8,8,4,8,8,4,8,8,4,4,4],tags:["middle","syncopation","bridge","loop_safe"],variations:["RM036","RM037"]},{id:"RM036",length:8,pattern:[8,8,4,8,8,4,8,8,4,4,4],tags:["middle","syncopation","bridge","loop_safe"],variations:["RM037","RM038"]},{id:"RM037",length:8,pattern:[8,8,4,8,8,4,8,8,4,4,4],tags:["middle","syncopation","bridge","loop_safe"],variations:["RM038","RM039"]},{id:"RM038",length:8,pattern:[8,8,4,8,8,4,8,8,4,4,4],tags:["middle","syncopation","bridge","loop_safe"],variations:["RM039","RM040"]},{id:"RM039",length:8,pattern:[8,8,4,8,8,4,8,8,4,4,4],tags:["middle","syncopation","bridge","loop_safe"],variations:["RM040","RM041"]},{id:"RM040",length:8,pattern:[8,8,4,8,8,4,8,8,4,4,4],tags:["middle","syncopation","bridge","loop_safe"],variations:["RM041","RM042"]},{id:"RM041",length:8,pattern:[8,8,4,8,8,4,8,8,4,4,4],tags:["middle","syncopation","bridge","loop_safe"],variations:["RM042","RM043"]},{id:"RM042",length:8,pattern:[8,8,4,8,8,4,8,8,4,4,4],tags:["middle","syncopation","bridge","loop_safe"],variations:["RM043","RM044"]},{id:"RM043",length:8,pattern:[8,8,4,8,8,4,8,8,4,4,4],tags:["middle","syncopation","bridge","loop_safe"],variations:["RM044","RM045"]},{id:"RM044",length:8,pattern:[8,8,4,8,8,4,8,8,4,4,4],tags:["middle","syncopation","bridge","loop_safe"],variations:["RM045","RM046"]},{id:"RM045",length:8,pattern:[8,8,4,8,8,4,8,8,4,4,4],tags:["middle","syncopation","bridge","loop_safe"],variations:["RM046","RM047"]},{id:"RM046",length:8,pattern:[8,8,4,8,8,4,8,8,4,4,4],tags:["middle","syncopation","bridge","loop_safe"],variations:["RM047","RM048"]},{id:"RM047",length:8,pattern:[8,8,4,8,8,4,8,8,4,4,4],tags:["middle","syncopation","bridge","loop_safe"],variations:["RM048","RM049"]},{id:"RM048",length:8,pattern:[8,8,4,8,8,4,8,8,4,4,4],tags:["middle","syncopation","bridge","loop_safe"],variations:["RM049","RM050"]},{id:"RM049",length:8,pattern:[8,8,4,8,8,4,8,8,4,4,4],tags:["middle","syncopation","bridge","loop_safe"],variations:["RM050","RM009"]},{id:"RM050",length:8,pattern:[8,8,4,8,8,4,8,8,4,4,4],tags:["middle","syncopation","bridge","loop_safe"],variations:["RM009","RM010"]},{id:"RM051",length:4,pattern:[8,8,4,8,8,4],tags:["start","accented","syncopation","loop_safe"],variations:["RM052","RM053"]},{id:"RM052",length:4,pattern:[4,8,8,4,4],tags:["middle","accented","bridge","loop_safe"],variations:["RM051","RM053"]},{id:"RM053",length:4,pattern:[8,8,8,8,4,4],tags:["end","accented","cadence","loop_safe"],variations:["RM051","RM052"]},{id:"RM054",length:4,pattern:[4,4,8,8,8,8],tags:["middle","accented","variation","loop_safe"],variations:["RM052","RM055"]},{id:"RM055",length:4,pattern:[4,8,8,8,8,4],tags:["start","accented","bridge","loop_safe"],variations:["RM051","RM054"]},{id:"RM056",length:4,pattern:[16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16],tags:["start","straight","texture_loop","grid16","loop_safe"],variations:["RM057"]},{id:"RM057",length:4,pattern:[16,16,16,16,16,16,16,8,8,16,16,16,16,16],tags:["middle","texture_loop","grid16","percussive_layer","loop_safe"],variations:["RM056"]},{id:"RM058",length:4,pattern:[16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16],tags:["start","middle","texture_loop","grid16","loop_safe","simple"],variations:["RM059","RM060"]},{id:"RM059",length:4,pattern:[16,16,16,16,16,16,8,16,16,16,16,16,16,16,16],tags:["middle","texture_loop","grid16","loop_safe","percussive_layer"],variations:["RM058","RM060"]},{id:"RM060",length:4,pattern:[16,16,8,16,16,16,16,8,16,16,16,16,8],tags:["middle","texture_loop","grid16","loop_safe","syncopation"],variations:["RM058","RM059"]},{id:"RM061",length:4,pattern:[8,8,8,8,8,8,8,8],tags:["start","middle","texture_loop","loop_safe","straight"],variations:["RM062"]},{id:"RM062",length:4,pattern:[8,8,8,16,16,8,8,8,16,16],tags:["middle","texture_loop","loop_safe","straight"],variations:["RM061"]},{id:"RM063",length:4,pattern:[16,16,16,16,8,16,16,16,16,8,16,16,16,16],tags:["start","middle","texture_loop","grid16","loop_safe","percussive_layer"],variations:["RM064"]},{id:"RM064",length:4,pattern:[16,16,16,16,16,16,16,16,8,16,16,16,16,8],tags:["middle","texture_loop","grid16","loop_safe","percussive_layer"],variations:["RM063"]},{id:"RM065",length:4,pattern:[4,16,16,16,16,4,16,16,16,16],tags:["start","middle","texture_loop","loop_safe","simple"],variations:["RM066"]},{id:"RM066",length:4,pattern:[4,16,16,16,16,8,8,16,16,16,16],tags:["middle","texture_loop","loop_safe"],variations:["RM065"]},{id:"RM067",length:4,pattern:[8,16,16,8,16,16,8,16,16,8,16,16],tags:["start","middle","texture_loop","loop_safe","straight"],variations:["RM068"]},{id:"RM068",length:4,pattern:[8,16,16,8,8,8,16,16,8,16,16],tags:["middle","texture_loop","loop_safe","syncopation"],variations:["RM067"]},{id:"RM069",length:4,pattern:[16,16,8,16,16,8,16,16,8,16,16,8],tags:["start","middle","texture_loop","grid16","loop_safe","percussive_layer"],variations:["RM070"]},{id:"RM070",length:4,pattern:[16,16,8,8,16,16,8,16,16,8,16,16],tags:["middle","texture_loop","grid16","loop_safe","percussive_layer"],variations:["RM069"]},{id:"RM071",length:4,pattern:[4,4,16,16,16,16,4],tags:["start","middle","texture_loop","loop_safe","accented"],variations:["RM072"]},{id:"RM072",length:4,pattern:[4,8,8,16,16,16,16,4],tags:["middle","end","texture_loop","loop_safe","accented"],variations:["RM071"]},{id:"RM073",length:8,pattern:[4,4,4,4,4,4,4,4],tags:["end","cadence","loop_safe","final"],variations:["RM074","RM075"]},{id:"RM074",length:8,pattern:[4,8,8,4,4,4,8,8,4,4],tags:["end","cadence","loop_safe","final"],variations:["RM073","RM075"]},{id:"RM075",length:8,pattern:[8,8,4,4,4,2,2],tags:["end","cadence","loop_safe","ritardando"],variations:["RM073","RM074"]},{id:"RM076",length:4,pattern:[8,8,8,8,4,4],tags:["start","anacrusis","staccato","loop_safe"],variations:["RM077","RM078"]},{id:"RM077",length:4,pattern:[16,16,16,16,8,8,4,4],tags:["start","anacrusis","drive","loop_safe"],variations:["RM076","RM078"]},{id:"RM078",length:4,pattern:[8,8,4,8,8,4],tags:["start","anacrusis","syncopation","loop_safe"],variations:["RM076","RM077"]},{id:"RM079",length:4,pattern:[8,16,16,4,8,16,16,4],tags:["middle","syncopation","drive","loop_safe"],variations:["RM080","RM081"]},{id:"RM080",length:4,pattern:[4,16,16,8,8,4,8],tags:["middle","syncopation","accented","loop_safe"],variations:["RM079","RM082"]},{id:"RM081",length:4,pattern:[16,16,8,16,16,8,16,16,8,4],tags:["start","syncopation","staccato","loop_safe"],variations:["RM079","RM082"]},{id:"RM082",length:4,pattern:[8,8,16,16,16,16,8,8,4],tags:["middle","syncopation","drive","loop_safe"],variations:["RM080","RM083"]},{id:"RM083",length:4,pattern:[4,8,16,16,8,8,4],tags:["middle","syncopation","bridge","loop_safe"],variations:["RM082","RM084"]},{id:"RM084",length:8,pattern:[8,16,16,8,16,16,4,4,8,16,16,8,16,16,4,4],tags:["middle","syncopation","drive","loop_safe"],variations:["RM083","RM085"]},{id:"RM085",length:8,pattern:[4,8,8,4,4,8,8,4,4,4],tags:["end","syncopation","cadence","loop_safe"],variations:["RM084","RM079"]},{id:"RM086",length:8,pattern:[8,8,4,8,8,4,8,8,4,8,8,4],tags:["middle","bridge","syncopation","loop_safe"],variations:["RM087","RM088"]},{id:"RM087",length:8,pattern:[4,4,8,8,8,8,4,4,8,8,8,8],tags:["middle","bridge","straight","loop_safe"],variations:["RM086","RM089"]},{id:"RM088",length:8,pattern:[16,16,16,16,8,8,4,4,16,16,16,16,8,8,4,4],tags:["middle","bridge","drive","loop_safe"],variations:["RM086","RM089"]},{id:"RM089",length:8,pattern:[8,8,8,8,4,4,8,8,8,8,4,4],tags:["middle","bridge","sustain","loop_safe"],variations:["RM087","RM090"]},{id:"RM090",length:8,pattern:[4,8,8,4,4,8,8,4,4,4],tags:["middle","bridge","variation","loop_safe"],variations:["RM089","RM086"]},{id:"RM091",length:4,pattern:[16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16],tags:["middle","texture_loop","grid16","percussive_layer","loop_safe","straight"]},{id:"RM092",length:4,pattern:[16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16],tags:["middle","texture_loop","grid16","percussive_layer","loop_safe","syncopation"]},{id:"RM093",length:4,pattern:[16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16],tags:["middle","texture_loop","grid16","percussive_layer","loop_safe","simple"]},{id:"RM094",length:4,pattern:[16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16],tags:["middle","texture_loop","grid16","percussive_layer","loop_safe","accented"]},{id:"RM095",length:4,pattern:[16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16],tags:["middle","texture_loop","grid16","percussive_layer","loop_safe","straight"]},{id:"RM096",length:4,pattern:[16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16],tags:["start","texture_loop","grid16","percussive_layer","loop_safe","straight"]},{id:"RM097",length:4,pattern:[8,8,16,16,16,16,8,8,16,16,16,16],tags:["start","texture_loop","grid16","percussive_layer","loop_safe","syncopation"]},{id:"RM098",length:4,pattern:[16,16,8,16,16,8,16,16,8,16,16,8],tags:["start","texture_loop","grid16","percussive_layer","loop_safe","simple"]},{id:"RM099",length:4,pattern:[16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16],tags:["start","texture_loop","grid16","percussive_layer","loop_safe","accented"]},{id:"RM100",length:4,pattern:[8,16,16,16,16,8,16,16,16,16,8,8],tags:["start","texture_loop","grid16","percussive_layer","loop_safe","open"]},{id:"RM101",length:4,pattern:[16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16],tags:["end","texture_loop","grid16","percussive_layer","loop_safe","straight"]},{id:"RM102",length:4,pattern:[8,16,16,16,16,8,8,16,16,16,16,8],tags:["end","texture_loop","grid16","percussive_layer","loop_safe","syncopation"]},{id:"RM103",length:4,pattern:[16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16],tags:["end","texture_loop","grid16","percussive_layer","loop_safe","simple"]},{id:"RM104",length:4,pattern:[16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16],tags:["end","texture_loop","grid16","percussive_layer","loop_safe","accented"]},{id:"RM105",length:4,pattern:[16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16],tags:["end","texture_loop","grid16","percussive_layer","loop_safe","open"]},{id:"RM106",length:4,pattern:[16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16],tags:["middle","texture_loop","grid16","percussive_layer","straight"]},{id:"RM107",length:4,pattern:[16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16],tags:["middle","texture_loop","grid16","percussive_layer","syncopation"]},{id:"RM108",length:4,pattern:[16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16],tags:["middle","texture_loop","grid16","percussive_layer","simple"]},{id:"RM109",length:4,pattern:[16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16],tags:["middle","texture_loop","grid16","percussive_layer","accented"]},{id:"RM110",length:4,pattern:[16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16],tags:["middle","texture_loop","grid16","percussive_layer","open"]},{id:"RM111",length:4,pattern:[{value:16,accent:!0},{value:16},{value:16,accent:!0},{value:16,rest:!0},{value:16},{value:16,accent:!0},{value:16},{value:16,rest:!0},{value:16,accent:!0},{value:16},{value:16,accent:!0},{value:16},{value:16,rest:!0},{value:16,accent:!0},{value:16},{value:16}],tags:["middle","texture_loop","grid16","syncopation","percussive_layer"]},{id:"RM112",length:4,pattern:[{value:8,accent:!0},{value:16},{value:16},{value:8},{value:16},{value:16,accent:!0},{value:8},{value:16},{value:16},{value:8,rest:!0},{value:16},{value:16}],tags:["middle","texture_loop","grid16","percussive_layer","drive"]},{id:"RM113",length:4,pattern:[{value:4,accent:!0},{value:16},{value:16},{value:16},{value:16,rest:!0},{value:16,accent:!0},{value:16},{value:16},{value:16,rest:!0},{value:16,accent:!0},{value:16},{value:16},{value:16}],tags:["middle","texture_loop","grid16","syncopation","break"]},{id:"RM114",length:4,pattern:[{value:16,accent:!0},{value:16},{value:16},{value:16,accent:!0},{value:16,rest:!0},{value:16,accent:!0},{value:16},{value:16},{value:16,accent:!0},{value:16,rest:!0},{value:16,accent:!0},{value:16},{value:16},{value:16,accent:!0},{value:16,rest:!0},{value:16,accent:!0}],tags:["middle","loop_safe","grid16","syncopation","breakbeat"]},{id:"RM115",length:4,pattern:[{value:8,accent:!0},{value:16,rest:!0},{value:8},{value:16,rest:!0},{value:4},{value:16,rest:!0},{value:8,accent:!0},{value:16,rest:!0},{value:16},{value:16,rest:!0}],tags:["middle","loop_safe","swing_hint","rest_heavy","lofi"]},{id:"RM116",length:4,pattern:[{value:8,accent:!0},{value:16},{value:16},{value:8,accent:!0},{value:16,rest:!0},{value:16,accent:!0},{value:8},{value:16,accent:!0},{value:16},{value:8,accent:!0},{value:16,rest:!0},{value:16,accent:!0}],tags:["middle","loop_safe","syncopation","grid16","breakbeat"]},{id:"RM117",length:4,pattern:[{value:16,accent:!0},{value:16},{value:16},{value:16,accent:!0},{value:16,rest:!0},{value:16,accent:!0},{value:16},{value:16,accent:!0},{value:16},{value:16,rest:!0},{value:16,accent:!0},{value:16},{value:16,accent:!0},{value:16},{value:16,rest:!0},{value:16,accent:!0}],tags:["middle","loop_safe","grid16","syncopation","breakbeat","variation"]},{id:"RM118",length:4,pattern:[{value:8,accent:!0},{value:16,rest:!0},{value:8},{value:16,rest:!0},{value:8,accent:!0},{value:8,rest:!0},{value:8},{value:16,rest:!0},{value:8},{value:16,rest:!0}],tags:["middle","loop_safe","swing_hint","rest_heavy","lofi"]},{id:"RM119",length:4,pattern:[{value:8,accent:!0},{value:16,rest:!0},{value:8},{value:16,rest:!0},{value:8},{value:16,rest:!0},{value:8,accent:!0},{value:16,rest:!0},{value:8},{value:8}],tags:["start","loop_safe","swing_hint","rest_heavy","lofi","variation"]}],pa=[{id:"MF001",pattern:[1,3,5],tags:["ascending","scalar","bright","heroic","start","loop_safe","short","slide"]},{id:"MF002",pattern:[1,4,5,7],tags:["ascending","scalar","bright","heroic","start","loop_safe","short","bend"]},{id:"MF003",pattern:[2,3,6,6,9],tags:["ascending","scalar","bright","heroic","start","loop_safe","short"]},{id:"MF004",pattern:[1,3,6,6,7],tags:["ascending","scalar","bright","heroic","start","loop_safe","short"]},{id:"MF005",pattern:[1,3,5,7,8],tags:["ascending","scalar","bright","heroic","start","loop_safe","short"]},{id:"MF006",pattern:[1,3,4],tags:["ascending","scalar","bright","heroic","start","loop_safe","short"]},{id:"MF007",pattern:[2,4,5,6],tags:["ascending","scalar","bright","heroic","start","loop_safe","short"]},{id:"MF008",pattern:[1,2,5,5,8],tags:["ascending","scalar","bright","heroic","start","loop_safe","short"]},{id:"MF009",pattern:[1,3,6,6,8],tags:["ascending","scalar","bright","heroic","start","loop_safe","short"]},{id:"MF010",pattern:[1,3,5,6,8],tags:["ascending","scalar","bright","heroic","start","loop_safe","short"]},{id:"MF011",pattern:[5,4,3],tags:["descending","scalar","dark","melancholic","cadence","short"]},{id:"MF012",pattern:[5,5,3,3],tags:["descending","scalar","dark","melancholic","cadence","short"]},{id:"MF013",pattern:[6,4,4,2,2],tags:["descending","scalar","dark","melancholic","cadence","short"]},{id:"MF014",pattern:[4,4,4,2,1],tags:["descending","scalar","dark","melancholic","cadence","short"]},{id:"MF015",pattern:[5,4,3,3,1],tags:["descending","scalar","dark","melancholic","cadence","short"]},{id:"MF016",pattern:[5,4,2],tags:["descending","scalar","dark","melancholic","cadence","short"]},{id:"MF017",pattern:[6,5,3,2],tags:["descending","scalar","dark","melancholic","cadence","short"]},{id:"MF018",pattern:[5,3,3,1,1],tags:["descending","scalar","dark","melancholic","cadence","short"]},{id:"MF019",pattern:[5,4,4,2,1],tags:["descending","scalar","dark","melancholic","cadence","short"]},{id:"MF020",pattern:[5,4,3,2,1],tags:["descending","scalar","dark","melancholic","cadence","short"]},{id:"MF021",pattern:[1,4,6],tags:["arch","leaping","bright","complex","middle","short"]},{id:"MF022",pattern:[1,5,6,6],tags:["arch","leaping","bright","complex","middle","short"]},{id:"MF023",pattern:[2,4,7,5,4],tags:["arch","leaping","bright","complex","middle","short"]},{id:"MF024",pattern:[1,4,7,5,2],tags:["arch","leaping","bright","complex","middle","short"]},{id:"MF025",pattern:[1,4,6,6,3],tags:["arch","leaping","bright","complex","middle","short"]},{id:"MF026",pattern:[1,4,5],tags:["arch","leaping","bright","complex","middle","short"]},{id:"MF027",pattern:[2,5,6,5],tags:["arch","leaping","bright","complex","middle","short"]},{id:"MF028",pattern:[1,3,6,4,3],tags:["arch","leaping","bright","complex","middle","short"]},{id:"MF029",pattern:[1,4,7,5,3],tags:["arch","leaping","bright","complex","middle","short"]},{id:"MF030",pattern:[1,4,6,5,3],tags:["arch","leaping","bright","complex","middle","short"]},{id:"MF031",pattern:[6,4,2],tags:["valley","neighbor","dark","complex","middle","short"]},{id:"MF032",pattern:[6,5,2,4],tags:["valley","neighbor","dark","complex","middle","short"]},{id:"MF033",pattern:[7,4,3,3,2],tags:["valley","neighbor","dark","complex","middle","short"]},{id:"MF034",pattern:[5,4,3,3,1],tags:["valley","neighbor","dark","complex","middle","short"]},{id:"MF035",pattern:[6,4,2,4,1],tags:["valley","neighbor","dark","complex","middle","short"]},{id:"MF036",pattern:[6,4,1],tags:["valley","neighbor","dark","complex","middle","short"]},{id:"MF037",pattern:[7,5,2,3],tags:["valley","neighbor","dark","complex","middle","short"]},{id:"MF038",pattern:[6,3,2,2,1],tags:["valley","neighbor","dark","complex","middle","short"]},{id:"MF039",pattern:[6,4,3,3,1],tags:["valley","neighbor","dark","complex","middle","short"]},{id:"MF040",pattern:[6,4,2,3,1],tags:["valley","neighbor","dark","complex","middle","short"]},{id:"MF041",pattern:[1,2,3],tags:["ascending","arpeggio","bright","simple","start","short"]},{id:"MF042",pattern:[1,3,3,6],tags:["ascending","arpeggio","bright","simple","start","short"]},{id:"MF043",pattern:[2,2,4,5,8],tags:["ascending","arpeggio","bright","simple","start","short"]},{id:"MF044",pattern:[1,2,4,5,6,6],tags:["ascending","arpeggio","bright","simple","start","extended"]},{id:"MF045",pattern:[1,2,3,6,7,7],tags:["ascending","arpeggio","bright","simple","start","extended"]},{id:"MF046",pattern:[1,2,2],tags:["ascending","arpeggio","bright","simple","start","short"]},{id:"MF047",pattern:[2,3,3,5],tags:["ascending","arpeggio","bright","simple","start","short"]},{id:"MF048",pattern:[1,1,3,4,7],tags:["ascending","arpeggio","bright","simple","start","short"]},{id:"MF049",pattern:[1,2,4,5,7,7],tags:["ascending","arpeggio","bright","simple","start","extended"]},{id:"MF050",pattern:[1,2,3,5,7,6],tags:["ascending","arpeggio","bright","simple","start","extended"]},{id:"MF051",pattern:[5,7,6],tags:["descending","arpeggio","dark","heroic","bridge","short"]},{id:"MF052",pattern:[5,8,6,5],tags:["descending","arpeggio","dark","heroic","bridge","short"]},{id:"MF053",pattern:[6,7,7,4,3],tags:["descending","arpeggio","dark","heroic","bridge","short"]},{id:"MF054",pattern:[4,7,7,4,1],tags:["descending","arpeggio","dark","heroic","bridge","short"]},{id:"MF055",pattern:[5,7,6,5,2],tags:["descending","arpeggio","dark","heroic","bridge","short"]},{id:"MF056",pattern:[5,7,5],tags:["descending","arpeggio","dark","heroic","bridge","short"]},{id:"MF057",pattern:[6,8,6,4],tags:["descending","arpeggio","dark","heroic","bridge","short"]},{id:"MF058",pattern:[5,6,6,3,2],tags:["descending","arpeggio","dark","heroic","bridge","short"]},{id:"MF059",pattern:[5,7,7,4,2],tags:["descending","arpeggio","dark","heroic","bridge","short"]},{id:"MF060",pattern:[5,7,6,4,2],tags:["descending","arpeggio","dark","heroic","bridge","short"]},{id:"MF061",pattern:[3,5,4],tags:["wave","scalar","peaceful","simple","loop_safe","short"]},{id:"MF062",pattern:[3,6,4,7],tags:["wave","scalar","peaceful","simple","loop_safe","short"]},{id:"MF063",pattern:[4,5,5,6,6],tags:["wave","scalar","peaceful","simple","loop_safe","short"]},{id:"MF064",pattern:[2,5,5,6,4,3],tags:["wave","scalar","peaceful","simple","loop_safe","extended"]},{id:"MF065",pattern:[3,5,4,7,5,4],tags:["wave","scalar","peaceful","simple","loop_safe","extended"]},{id:"MF066",pattern:[3,5,3],tags:["wave","scalar","peaceful","simple","loop_safe","short"]},{id:"MF067",pattern:[4,6,4,6],tags:["wave","scalar","peaceful","simple","loop_safe","short"]},{id:"MF068",pattern:[3,4,4,5,5],tags:["wave","scalar","peaceful","simple","loop_safe","short"]},{id:"MF069",pattern:[3,5,5,6,5,4],tags:["wave","scalar","peaceful","simple","loop_safe","extended"]},{id:"MF070",pattern:[3,5,4,6,5,3],tags:["wave","scalar","peaceful","simple","loop_safe","extended"]},{id:"MF071",pattern:[2,4,6],tags:["ascending","sequence","tense","complex","build","short"]},{id:"MF072",pattern:[2,5,6,6],tags:["ascending","sequence","tense","complex","build","short"]},{id:"MF073",pattern:[3,4,7,5,4],tags:["ascending","sequence","tense","complex","build","short"]},{id:"MF074",pattern:[1,4,7,5,2,1],tags:["ascending","sequence","tense","complex","build","extended"]},{id:"MF075",pattern:[2,4,6,6,3,2],tags:["ascending","sequence","tense","complex","build","extended"]},{id:"MF076",pattern:[2,4,5],tags:["ascending","sequence","tense","complex","build","short"]},{id:"MF077",pattern:[3,5,6,5],tags:["ascending","sequence","tense","complex","build","short"]},{id:"MF078",pattern:[2,3,6,4,3],tags:["ascending","sequence","tense","complex","build","short"]},{id:"MF079",pattern:[2,4,7,5,3,2],tags:["ascending","sequence","tense","complex","build","extended"]},{id:"MF080",pattern:[2,4,6,5,3,1],tags:["ascending","sequence","tense","complex","build","extended"]},{id:"MF081",pattern:[1,5,3],tags:["arch","leaping","upbeat","bright","start","short"]},{id:"MF082",pattern:[1,6,3,7],tags:["arch","leaping","upbeat","bright","start","short"]},{id:"MF083",pattern:[2,5,4,6,5],tags:["arch","leaping","upbeat","bright","start","short"]},{id:"MF084",pattern:[1,5,4,6,3,7],tags:["arch","leaping","upbeat","bright","start","extended"]},{id:"MF085",pattern:[1,5,3,7,4,8],tags:["arch","leaping","upbeat","bright","start","extended"]},{id:"MF086",pattern:[1,5,2],tags:["arch","leaping","upbeat","bright","start","short"]},{id:"MF087",pattern:[2,6,3,6],tags:["arch","leaping","upbeat","bright","start","short"]},{id:"MF088",pattern:[1,4,3,5,4],tags:["arch","leaping","upbeat","bright","start","short"]},{id:"MF089",pattern:[1,5,4,6,4,8],tags:["arch","leaping","upbeat","bright","start","extended"]},{id:"MF090",pattern:[1,5,3,6,4,7],tags:["arch","leaping","upbeat","bright","start","extended"]},{id:"MF091",pattern:[6,3,5],tags:["valley","leaping","tense","dark","cadence","loop_safe","short"]},{id:"MF092",pattern:[6,4,5,3],tags:["valley","leaping","tense","dark","cadence","loop_safe","short"]},{id:"MF093",pattern:[7,3,6,2,5],tags:["valley","leaping","tense","dark","cadence","loop_safe","short"]},{id:"MF094",pattern:[5,3,6,2,3,1],tags:["valley","leaping","tense","dark","cadence","loop_safe","extended"]},{id:"MF095",pattern:[6,3,5,3,4,2],tags:["valley","leaping","tense","dark","cadence","loop_safe","extended"]},{id:"MF096",pattern:[6,3,4],tags:["valley","leaping","tense","dark","cadence","loop_safe","short"]},{id:"MF097",pattern:[7,4,5,2],tags:["valley","leaping","tense","dark","cadence","loop_safe","short"]},{id:"MF098",pattern:[6,2,5,1,4],tags:["valley","leaping","tense","dark","cadence","loop_safe","short"]},{id:"MF099",pattern:[6,3,6,2,4,2],tags:["valley","leaping","tense","dark","cadence","loop_safe","extended"]},{id:"MF100",pattern:[6,3,5,2,4,1],tags:["valley","leaping","tense","dark","cadence","loop_safe","extended"]},{id:"MF101",pattern:[1,1,1,1],tags:["flat","static","texture_loop","loop_safe","simple","ostinato"]},{id:"MF102",pattern:[1,5,1,5],tags:["flat","texture_loop","loop_safe","ostinato","percussive_layer"]},{id:"MF103",pattern:[1,1,1,1],tags:["flat","static","drone","loop_safe","simple"]},{id:"MF104",pattern:[1,1,1,2,1],tags:["flat","static","drone","loop_safe","simple"]},{id:"MF105",pattern:[5,5,5,5],tags:["flat","static","drone","loop_safe","simple"]},{id:"MF106",pattern:[1,2,1,2],tags:["flat","static","drone","loop_safe","ostinato","simple"]},{id:"MF107",pattern:[3,3,3,3],tags:["flat","static","drone","loop_safe","simple"]},{id:"MF108",pattern:[1,3,1,3],tags:["flat","static","drone","loop_safe","ostinato"]},{id:"MF109",pattern:[1,1,5,1,1,5],tags:["flat","static","loop_safe","ostinato","percussive_layer"]},{id:"MF110",pattern:[1,1,1,1,1,1],tags:["flat","static","drone","loop_safe","simple","texture_loop"]},{id:"MF111",pattern:[5,6,7,1],tags:["mysterious","ascending","dark","start","loop_safe","short"]},{id:"MF112",pattern:[1,7,6,5],tags:["mysterious","descending","dark","middle","loop_safe","short"]},{id:"MF113",pattern:[3,1,6,5],tags:["mysterious","complex","dark","tense","loop_safe","short"]},{id:"MF114",pattern:[1,2,3,2,1],tags:["playful","neighbor","bright","simple","loop_safe","short"]},{id:"MF115",pattern:[5,4,3,4,5],tags:["playful","wave","bright","upbeat","loop_safe","short"]},{id:"MF116",pattern:[1,3,5,3,1],tags:["playful","arch","bright","simple","loop_safe","short"]},{id:"MF117",pattern:[1,5,1,5],tags:["epic","leaping","bright","heroic","loop_safe","short"]},{id:"MF118",pattern:[5,6,7,1,2],tags:["epic","ascending","bright","heroic","build","short"]},{id:"MF119",pattern:[1,3,5,7,1],tags:["epic","ascending","arpeggio","heroic","bright","short"]},{id:"MF120",pattern:[6,5,4,3],tags:["mysterious","descending","scalar","dark","loop_safe","short"]},{id:"MF121",pattern:[3,5,3,1],tags:["playful","wave","bright","simple","loop_safe","short"]},{id:"MF122",pattern:[5,3,1,5],tags:["epic","leaping","arpeggio","heroic","loop_safe","short"]},{id:"MF123",pattern:[1,6,5,1],tags:["mysterious","complex","dark","cadence","loop_safe","short"]},{id:"MF124",pattern:[2,3,4,5],tags:["playful","ascending","scalar","bright","loop_safe","short"]},{id:"MF125",pattern:[1,4,7,4,1],tags:["epic","arch","leaping","heroic","bright","extended"]},{id:"MF126",pattern:[5,7,6,5,3],tags:["mysterious","complex","dark","descending","loop_safe","extended"]},{id:"MF127",pattern:[1,1,3,3,5,5],tags:["playful","sequence","ascending","bright","loop_safe","extended"]},{id:"MF128",pattern:[1,7,1,5],tags:["epic","leaping","heroic","bright","loop_safe","short"]},{id:"MF129",pattern:[3,2,1,6],tags:["mysterious","descending","dark","tense","loop_safe","short"]},{id:"MF130",pattern:[5,5,6,6,7,7,1],tags:["epic","sequence","ascending","heroic","build","extended"]},{id:"MF131",pattern:[5,4,3,1],tags:["mysterious","descending","dark","start","loop_safe","short"]},{id:"MF132",pattern:[6,5,4,2],tags:["mysterious","descending","dark","start","loop_safe","short"]},{id:"MF133",pattern:[7,5,3,1],tags:["mysterious","descending","dark","start","loop_safe","short"]},{id:"MF134",pattern:[5,3,2,1],tags:["mysterious","descending","dark","start","loop_safe","short"]},{id:"MF135",pattern:[6,4,3,1],tags:["mysterious","descending","dark","start","loop_safe","short"]},{id:"MF136",pattern:[1,2,3,5],tags:["mysterious","ascending","dark","middle","stepwise","short"]},{id:"MF137",pattern:[1,3,5,6],tags:["mysterious","ascending","dark","middle","stepwise","short"]},{id:"MF138",pattern:[2,3,4,6],tags:["mysterious","ascending","dark","middle","stepwise","short"]},{id:"MF139",pattern:[1,2,4,5],tags:["mysterious","ascending","dark","middle","stepwise","short"]},{id:"MF140",pattern:[3,4,5,7],tags:["mysterious","ascending","dark","middle","stepwise","short"]},{id:"MF141",pattern:[7,6,5,4,3],tags:["mysterious","descending","dark","end","static","short"]},{id:"MF142",pattern:[5,4,3,2,1],tags:["mysterious","descending","dark","end","static","short"]},{id:"MF143",pattern:[6,5,4,3,1],tags:["mysterious","descending","dark","end","static","short"]},{id:"MF144",pattern:[7,5,4,2,1],tags:["mysterious","descending","dark","end","static","short"]},{id:"MF145",pattern:[5,4,3,1],tags:["mysterious","descending","dark","end","static","short"]},{id:"MF146",pattern:[1,2,1,3,1],tags:["mysterious","texture_loop","ostinato","loop_safe","short","dark"]},{id:"MF147",pattern:[5,6,5,7,5],tags:["mysterious","texture_loop","ostinato","loop_safe","short","dark"]},{id:"MF148",pattern:[1,3,1,2,1],tags:["mysterious","texture_loop","ostinato","loop_safe","short","dark"]},{id:"MF149",pattern:[5,7,5,6,5],tags:["mysterious","texture_loop","ostinato","loop_safe","short","dark"]},{id:"MF150",pattern:[1,4,1,3,1],tags:["mysterious","texture_loop","ostinato","loop_safe","short","dark"]},{id:"MF151",pattern:[1,4,6,5,7,6,4],tags:["breakbeat","tense","leaping","loop_safe","short"]},{id:"MF152",pattern:[5,3,6,4,7,5],tags:["breakbeat","tense","sequence","loop_safe","short","variation"]},{id:"MF153",pattern:[1,5,4,6,3,7,5],tags:["breakbeat","upbeat","leaping","loop_safe","extended"]},{id:"MF154",pattern:[1,1,3,2,1],tags:["lofi","peaceful","stepwise","loop_safe","short"]},{id:"MF155",pattern:[5,4,4,3,2,2],tags:["lofi","peaceful","descending","loop_safe","long"]},{id:"MF156",pattern:[1,3,2,5,4,3,1],tags:["lofi","melancholic","stepwise","loop_safe","extended"]}],ha=[{id:"MR001",length:4,pattern:[{value:4},{value:8},{value:8},{value:4},{value:8,rest:!0},{value:8}],tags:["start","simple","drive","loop_safe"]},{id:"MR002",length:4,pattern:[{value:8},{value:8},{value:8},{value:8},{value:4},{value:4}],tags:["middle","syncopated","drive"]},{id:"MR003",length:4,pattern:[{value:4},{value:4},{value:4},{value:4}],tags:["start","legato","simple"]},{id:"MR004",length:4,pattern:[{value:8,rest:!0},{value:8},{value:8,rest:!0},{value:8},{value:4},{value:4}],tags:["middle","rest_heavy","staccato"]},{id:"MR005",length:4,pattern:[{value:8},{value:8},{value:4},{value:8},{value:8},{value:4}],tags:["middle","syncopated","drive"]},{id:"MR006",length:4,pattern:[{value:4},{value:8,rest:!0},{value:8},{value:4},{value:8,rest:!0},{value:8}],tags:["middle","legato","rest_heavy"]},{id:"MR007",length:4,pattern:[{value:8},{value:8},{value:8},{value:8},{value:8},{value:8},{value:8},{value:8}],tags:["start","staccato","drive"]},{id:"MR008",length:8,pattern:[{value:8},{value:8},{value:4},{value:4},{value:8,rest:!0},{value:8},{value:8,rest:!0},{value:8},{value:4},{value:4},{value:4}],tags:["start","bridge","legato"]},{id:"MR009",length:4,pattern:[{value:4},{value:8,rest:!0},{value:8},{value:4},{value:8,rest:!0},{value:16},{value:16}],tags:["end","legato","loop_safe","cadence"]},{id:"MR010",length:4,pattern:[{value:8},{value:8},{value:8,rest:!0},{value:8},{value:4},{value:4}],tags:["end","syncopated","staccato","loop_safe","cadence"]},{id:"MR011",length:4,pattern:[{value:8,rest:!0},{value:8},{value:4},{value:8,rest:!0},{value:16,rest:!0},{value:16},{value:4}],tags:["start","legato","rest_heavy","loop_safe"]},{id:"MR012",length:4,pattern:[{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:8},{value:8},{value:8},{value:8}],tags:["middle","staccato","drive","syncopated"]},{id:"MR013",length:4,pattern:[{value:8,rest:!0},{value:8,rest:!0},{value:4},{value:8},{value:8},{value:4}],tags:["middle","rest_heavy","simple"]},{id:"MR014",length:4,pattern:[{value:4},{value:8},{value:8},{value:16,rest:!0},{value:16},{value:4},{value:8}],tags:["middle","syncopated","drive","accented"]},{id:"MR015",length:4,pattern:[{value:8,rest:!0},{value:8},{value:4},{value:8,rest:!0},{value:16,rest:!0},{value:16},{value:8},{value:8}],tags:["end","legato","rest_heavy","loop_safe"]},{id:"MR016",length:8,pattern:[{value:4},{value:8},{value:8},{value:4},{value:16,rest:!0},{value:16,rest:!0},{value:16},{value:16},{value:4},{value:4},{value:8},{value:8},{value:4}],tags:["bridge","legato","rest_heavy"]},{id:"MR017",length:8,pattern:[{value:8},{value:8},{value:8},{value:8},{value:8,rest:!0},{value:8},{value:8,rest:!0},{value:8},{value:4},{value:4},{value:8},{value:8},{value:4}],tags:["bridge","syncopated","drive"]},{id:"MR018",length:8,pattern:[{value:4},{value:4},{value:8,rest:!0},{value:8},{value:4},{value:4},{value:8,rest:!0},{value:8},{value:4},{value:4}],tags:["end","legato","loop_safe","cadence"]},{id:"MR019",length:4,pattern:[{value:4},{value:8},{value:8},{value:16,rest:!0},{value:16},{value:16,rest:!0},{value:16},{value:8},{value:8}],tags:["start","drive","accented"]},{id:"MR020",length:4,pattern:[{value:8,rest:!0},{value:8},{value:4},{value:8,rest:!0},{value:16,rest:!0},{value:16},{value:8},{value:8}],tags:["middle","rest_heavy","simple"]},{id:"MR021",length:4,pattern:[{value:16},{value:16},{value:16},{value:16},{value:8},{value:8},{value:4},{value:8,rest:!0},{value:8}],tags:["middle","staccato","drive","syncopated"]},{id:"MR022",length:4,pattern:[{value:4},{value:8,rest:!0},{value:16,rest:!0},{value:16},{value:4},{value:8,rest:!0},{value:8}],tags:["end","legato","loop_safe"]},{id:"MR023",length:8,pattern:[{value:8},{value:8},{value:4},{value:4},{value:8},{value:8},{value:4},{value:8,rest:!0},{value:8},{value:4},{value:8,rest:!0},{value:8}],tags:["bridge","syncopated","drive","accented"]},{id:"MR024",length:8,pattern:[{value:4},{value:8,rest:!0},{value:8},{value:4},{value:4},{value:8,rest:!0},{value:8},{value:4},{value:8,rest:!0},{value:8},{value:4}],tags:["bridge","legato","rest_heavy"]},{id:"MR025",length:8,pattern:[{value:8},{value:8},{value:4},{value:8,rest:!0},{value:8,rest:!0},{value:4},{value:4},{value:8,rest:!0},{value:8,rest:!0},{value:4},{value:4}],tags:["end","legato","loop_safe","cadence"]},{id:"MR026",length:4,pattern:[{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16}],tags:["start","texture_loop","grid16","drive","loop_safe"]},{id:"MR027",length:4,pattern:[{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:8},{value:8},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16}],tags:["middle","texture_loop","grid16","loop_safe","percussive_layer"]},{id:"MR028",length:4,pattern:[{value:8},{value:8},{value:8},{value:8},{value:8},{value:8},{value:8},{value:8}],tags:["start","middle","texture_loop","simple","loop_safe","percussive_layer"]},{id:"MR029",length:4,pattern:[{value:8},{value:16},{value:16},{value:8},{value:8},{value:16},{value:16},{value:8},{value:8},{value:8}],tags:["middle","texture_loop","loop_safe","percussive_layer"]},{id:"MR030",length:4,pattern:[{value:4},{value:16},{value:16},{value:16},{value:16},{value:4},{value:16},{value:16},{value:16},{value:16}],tags:["start","middle","texture_loop","loop_safe","percussive_layer"]},{id:"MR031",length:4,pattern:[{value:16},{value:16},{value:8},{value:16},{value:16},{value:8},{value:16},{value:16},{value:8},{value:16},{value:16},{value:8}],tags:["start","middle","texture_loop","grid16","loop_safe","percussive_layer"]},{id:"MR032",length:4,pattern:[{value:8},{value:8},{value:16},{value:16},{value:8},{value:16},{value:16},{value:8},{value:16},{value:16},{value:8}],tags:["middle","texture_loop","loop_safe","percussive_layer","syncopated"]},{id:"MR033",length:4,pattern:[{value:16},{value:16},{value:16},{value:16},{value:8},{value:16},{value:16},{value:16},{value:16},{value:8},{value:16},{value:16},{value:8}],tags:["start","middle","texture_loop","grid16","loop_safe","percussive_layer"]},{id:"MR034",length:8,pattern:[{value:4},{value:4},{value:16,rest:!0},{value:16},{value:16,rest:!0},{value:16},{value:4},{value:16,rest:!0},{value:16},{value:16,rest:!0},{value:16},{value:4},{value:4},{value:16,rest:!0},{value:16},{value:16,rest:!0},{value:16}],tags:["middle","end","staccato","rest_heavy","percussive_layer","loop_safe"]},{id:"MR035",length:4,pattern:[{value:8},{value:16,rest:!0},{value:16},{value:8},{value:16,rest:!0},{value:16},{value:8},{value:16,rest:!0},{value:16},{value:8},{value:16,rest:!0},{value:16}],tags:["start","middle","staccato","rest_heavy","percussive_layer","loop_safe"]},{id:"MR036",length:4,pattern:[{value:4},{value:8,rest:!0},{value:8},{value:8,rest:!0},{value:8},{value:16},{value:16},{value:16},{value:16}],tags:["start","middle","rest_heavy","loop_safe","simple"]},{id:"MR037",length:4,pattern:[{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:8},{value:16},{value:16},{value:8},{value:16},{value:16}],tags:["middle","end","texture_loop","grid16","loop_safe","percussive_layer"]},{id:"MR038",length:8,pattern:[{value:4},{value:4},{value:4},{value:8},{value:8},{value:4},{value:8},{value:8},{value:4},{value:4}],tags:["start","drive","syncopated"]},{id:"MR039",length:8,pattern:[{value:8},{value:8},{value:8},{value:8},{value:4},{value:4},{value:4},{value:4},{value:4},{value:4}],tags:["start","simple","drive"]},{id:"MR040",length:8,pattern:[{value:4},{value:8,rest:!0},{value:8},{value:4},{value:4},{value:8},{value:8},{value:4},{value:4},{value:8,rest:!0},{value:8}],tags:["start","legato","rest_heavy"]},{id:"MR041",length:8,pattern:[{value:8},{value:8},{value:4},{value:8},{value:8},{value:4},{value:4},{value:8},{value:8},{value:4},{value:4}],tags:["start","syncopated","drive"]},{id:"MR042",length:8,pattern:[{value:4},{value:4},{value:8},{value:8},{value:8},{value:8},{value:4},{value:4},{value:4},{value:4}],tags:["start","simple","legato"]},{id:"MR043",length:8,pattern:[{value:16},{value:16},{value:8},{value:16},{value:16},{value:8},{value:4},{value:4},{value:16},{value:16},{value:8},{value:4},{value:4},{value:4}],tags:["start","staccato","drive"]},{id:"MR044",length:8,pattern:[{value:8,rest:!0},{value:8},{value:4},{value:4},{value:8,rest:!0},{value:8},{value:4},{value:4},{value:4},{value:4}],tags:["start","rest_heavy","simple"]},{id:"MR045",length:8,pattern:[{value:4},{value:8},{value:8},{value:4},{value:8},{value:8},{value:4},{value:4},{value:4},{value:4}],tags:["start","syncopated","accented"]},{id:"MR046",length:8,pattern:[{value:8},{value:8},{value:4},{value:4},{value:8},{value:8},{value:4},{value:4},{value:4},{value:4}],tags:["middle","drive","syncopated"]},{id:"MR047",length:8,pattern:[{value:4},{value:4},{value:4},{value:4},{value:4},{value:4},{value:4},{value:4}],tags:["middle","simple","legato"]},{id:"MR048",length:8,pattern:[{value:8},{value:8},{value:8},{value:8},{value:4},{value:4},{value:4},{value:4},{value:4},{value:4}],tags:["middle","staccato","drive"]},{id:"MR049",length:8,pattern:[{value:4},{value:8,rest:!0},{value:8},{value:4},{value:8,rest:!0},{value:8},{value:4},{value:4},{value:4},{value:4}],tags:["middle","rest_heavy","legato"]},{id:"MR050",length:8,pattern:[{value:8},{value:16},{value:16},{value:8},{value:8},{value:4},{value:8},{value:8},{value:4},{value:4},{value:4},{value:4}],tags:["middle","syncopated","accented"]},{id:"MR051",length:8,pattern:[{value:4},{value:8},{value:8},{value:4},{value:4},{value:8},{value:8},{value:4},{value:4},{value:4}],tags:["middle","simple","drive"]},{id:"MR052",length:8,pattern:[{value:16},{value:16},{value:8},{value:16},{value:16},{value:8},{value:4},{value:4},{value:4},{value:4},{value:4},{value:4}],tags:["middle","staccato","syncopated"]},{id:"MR053",length:8,pattern:[{value:8,rest:!0},{value:8},{value:8,rest:!0},{value:8},{value:4},{value:4},{value:4},{value:4},{value:4},{value:4}],tags:["middle","rest_heavy","staccato"]},{id:"MR054",length:8,pattern:[{value:4},{value:4},{value:8},{value:8},{value:4},{value:4},{value:8},{value:8},{value:4},{value:4}],tags:["end","legato","loop_safe","cadence"]},{id:"MR055",length:8,pattern:[{value:8},{value:8},{value:4},{value:8},{value:8},{value:4},{value:8,rest:!0},{value:8},{value:4},{value:4},{value:4}],tags:["end","syncopated","loop_safe","cadence"]},{id:"MR056",length:8,pattern:[{value:4},{value:8},{value:8},{value:4},{value:4},{value:4},{value:4},{value:4},{value:4}],tags:["end","simple","loop_safe","cadence"]},{id:"MR057",length:8,pattern:[{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16}],tags:["middle","texture_loop","grid16","loop_safe","percussive_layer"]},{id:"MR058",length:8,pattern:[{value:8},{value:8},{value:8},{value:8},{value:8},{value:8},{value:8},{value:8},{value:8},{value:8},{value:8},{value:8},{value:8},{value:8},{value:8},{value:8}],tags:["middle","texture_loop","simple","loop_safe","percussive_layer"]},{id:"MR059",length:8,pattern:[{value:16},{value:16},{value:8},{value:16},{value:16},{value:8},{value:16},{value:16},{value:8},{value:16},{value:16},{value:8},{value:16},{value:16},{value:8},{value:16},{value:16},{value:8},{value:16},{value:16},{value:8},{value:16},{value:16},{value:8}],tags:["middle","texture_loop","grid16","loop_safe","percussive_layer"]},{id:"MR060",length:8,pattern:[{value:8},{value:16},{value:16},{value:8},{value:16},{value:16},{value:8},{value:16},{value:16},{value:8},{value:16},{value:16},{value:8},{value:16},{value:16},{value:8},{value:16},{value:16},{value:8},{value:16},{value:16},{value:8},{value:16},{value:16}],tags:["middle","end","texture_loop","loop_safe","percussive_layer"]},{id:"MR061",length:8,pattern:[{value:4},{value:16},{value:16},{value:16},{value:16},{value:4},{value:16},{value:16},{value:16},{value:16},{value:4},{value:16},{value:16},{value:16},{value:16},{value:4},{value:16},{value:16},{value:16},{value:16}],tags:["middle","texture_loop","grid16","loop_safe","percussive_layer"]},{id:"MR062",length:4,pattern:[{value:16,accent:!0},{value:16},{value:16,rest:!0},{value:16},{value:16,accent:!0},{value:16},{value:16,rest:!0},{value:16},{value:16,accent:!0},{value:16},{value:16,rest:!0},{value:16,accent:!0},{value:16},{value:16,rest:!0},{value:16,accent:!0},{value:16}],tags:["middle","texture_loop","grid16","syncopated","drive"]},{id:"MR063",length:4,pattern:[{value:8,accent:!0},{value:16},{value:16},{value:8},{value:16},{value:16,accent:!0},{value:8},{value:16},{value:16},{value:8,rest:!0},{value:16},{value:16}],tags:["middle","texture_loop","grid16","percussive_layer","ostinato"]},{id:"MR064",length:4,pattern:[{value:4,accent:!0},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16},{value:16}],tags:["start","texture_loop","grid16","percussive_layer","loop_safe"]}],ga=[{id:"DP001",length_beats:4,type:"beat",pattern:"K-H-S-H-K-H-S-H-",tags:["loop_safe"]},{id:"DP002",length_beats:4,type:"beat",pattern:"H-S-H-K-H-S-H-K-",tags:["loop_safe","variation"]},{id:"DP003",length_beats:4,type:"beat",pattern:"K---S---K-H-S-H",tags:["bridge"]},{id:"DP004",length_beats:4,type:"beat",pattern:"--S---K-H-S-HK-",tags:["bridge","variation"]},{id:"DP005",length_beats:4,type:"beat",pattern:"K-H-K---S-H-K---",tags:["build"]},{id:"DP006",length_beats:4,type:"beat",pattern:"H-K---S-H-K---K-",tags:["build","variation"]},{id:"DP007",length_beats:4,type:"beat",pattern:"K---S-H-K---S-H-",tags:["straight"]},{id:"DP008",length_beats:4,type:"beat",pattern:"--S-H-K---S-H-K-",tags:["straight","variation"]},{id:"DP009",length_beats:4,type:"beat",pattern:"K-H---S-K-H---S-",tags:["syncopation"]},{id:"DP010",length_beats:4,type:"beat",pattern:"H---S-K-H---S-K-",tags:["syncopation","variation"]},{id:"DP011",length_beats:4,type:"beat",pattern:"K---H-K-S---H-K-",tags:["open"]},{id:"DP012",length_beats:4,type:"beat",pattern:"--H-K-S---H-K-K-",tags:["open","variation"]},{id:"DP013",length_beats:4,type:"beat",pattern:"K-H-K-H-S-H-K-H-",tags:["loop_safe"]},{id:"DP014",length_beats:4,type:"beat",pattern:"H-K-H-S-H-K-H-K-",tags:["loop_safe","variation"]},{id:"DP015",length_beats:4,type:"beat",pattern:"K---S---K---H---",tags:["simple"]},{id:"DP016",length_beats:4,type:"beat",pattern:"--S---K---H---K-",tags:["simple","variation"]},{id:"DP017",length_beats:4,type:"beat",pattern:"K-H---K-S-H---K-",tags:["bridge"]},{id:"DP018",length_beats:4,type:"beat",pattern:"H---K-S-H---K-K-",tags:["bridge","variation"]},{id:"DP019",length_beats:4,type:"beat",pattern:"K--H-K--S-H-K--",tags:["swing_hint"]},{id:"DP020",length_beats:4,type:"beat",pattern:"-H-K--S-H-K--K-",tags:["swing_hint","variation"]},{id:"DP021",length_beats:4,type:"fill",pattern:"S-S-S-S-S-S-O---",tags:["cadence"]},{id:"DP022",length_beats:4,type:"fill",pattern:"S-S-S-S-O---S-S-",tags:["cadence","variation"]},{id:"DP023",length_beats:8,type:"fill",pattern:"S-S-S-S-S-S-O---S-S-S-S-S-S-O---",tags:["cadence","extended"]},{id:"DP024",length_beats:4,type:"fill",pattern:"KSKO-KSKO-KSKO-K",tags:["build"]},{id:"DP025",length_beats:4,type:"fill",pattern:"-KSKO-KSKO-KKSKO",tags:["build","variation"]},{id:"DP026",length_beats:8,type:"fill",pattern:"KSKO-KSKO-KSKO-KKSKO-KSKO-KSKO-K",tags:["build","extended"]},{id:"DP027",length_beats:4,type:"fill",pattern:"S-HS-HS-HS-HS-HS",tags:["bridge"]},{id:"DP028",length_beats:4,type:"fill",pattern:"-HS-HS-HS-HSS-HS",tags:["bridge","variation"]},{id:"DP029",length_beats:8,type:"fill",pattern:"S-HS-HS-HS-HS-HSS-HS-HS-HS-HS-HS",tags:["bridge","extended"]},{id:"DP030",length_beats:4,type:"fill",pattern:"K-SK-SK-SK-SK-SK",tags:["build"]},{id:"DP031",length_beats:4,type:"fill",pattern:"-SK-SK-SK-SKK-SK",tags:["build","variation"]},{id:"DP032",length_beats:8,type:"fill",pattern:"K-SK-SK-SK-SK-SKK-SK-SK-SK-SK-SK",tags:["build","extended"]},{id:"DP033",length_beats:4,type:"fill",pattern:"S--S-HHS--S-HHS-",tags:["break"]},{id:"DP034",length_beats:4,type:"fill",pattern:"-HHS--S-HHS-S--S",tags:["break","variation"]},{id:"DP035",length_beats:8,type:"fill",pattern:"S--S-HHS--S-HHS-S--S-HHS--S-HHS-",tags:["break","extended"]},{id:"DP036",length_beats:4,type:"fill",pattern:"K-K-K-K-S-S-S-S-",tags:["cadence"]},{id:"DP037",length_beats:4,type:"fill",pattern:"K-K-S-S-S-S-K-K-",tags:["cadence","variation"]},{id:"DP038",length_beats:8,type:"fill",pattern:"K-K-K-K-S-S-S-S-K-K-K-K-S-S-S-S-",tags:["cadence","extended"]},{id:"DP039",length_beats:4,type:"fill",pattern:"S-S-H-H-S-S-H-H-",tags:["bridge"]},{id:"DP040",length_beats:4,type:"fill",pattern:"H-H-S-S-H-H-S-S-",tags:["bridge","variation"]},{id:"DP041",length_beats:8,type:"fill",pattern:"S-S-H-H-S-S-H-H-S-S-H-H-S-S-H-H-",tags:["bridge","extended"]},{id:"DP042",length_beats:4,type:"fill",pattern:"KSTK-KSTK-KSTK-K",tags:["toms"]},{id:"DP043",length_beats:4,type:"fill",pattern:"-KSTK-KSTK-KKSTK",tags:["toms","variation"]},{id:"DP044",length_beats:8,type:"fill",pattern:"KSTK-KSTK-KSTK-KKSTK-KSTK-KSTK-K",tags:["toms","extended"]},{id:"DP045",length_beats:4,type:"fill",pattern:"S--S--S--S--S--S",tags:["loop_safe"]},{id:"DP046",length_beats:4,type:"fill",pattern:"--S--S--S--SS--S",tags:["loop_safe","variation"]},{id:"DP047",length_beats:8,type:"fill",pattern:"S--S--S--S--S--SS--S--S--S--S--S",tags:["loop_safe","extended"]},{id:"DP048",length_beats:4,type:"fill",pattern:"K-S-H-K-S-H-K-S-",tags:["bridge"]},{id:"DP049",length_beats:4,type:"fill",pattern:"H-K-S-H-K-S-K-S-",tags:["bridge","variation"]},{id:"DP050",length_beats:8,type:"fill",pattern:"K-S-H-K-S-H-K-S-K-S-H-K-S-H-K-S-",tags:["bridge","extended"]},{id:"DP051",length_beats:4,type:"beat",pattern:"K-H-K-H-K-H-K-H-",tags:["loop_safe","four_on_floor","straight","percussive_layer","texture_loop"]},{id:"DP052",length_beats:4,type:"beat",pattern:"K-HO-K-H-K-O-K-H-",tags:["loop_safe","four_on_floor","straight","variation","percussive_layer"]},{id:"DP053",length_beats:4,type:"beat",pattern:"K-HH-K-HH-K-HH-K-HH",tags:["loop_safe","grid16","texture_loop","percussive_layer"]},{id:"DP054",length_beats:4,type:"beat",pattern:"K--S--K-K--S--K-",tags:["rock","drive","loop_safe"]},{id:"DP055",length_beats:4,type:"beat",pattern:"K-K-S---K-K-S-K-",tags:["dance","syncopation","loop_safe"]},{id:"DP056",length_beats:4,type:"beat",pattern:"K-----S-K-----S-",tags:["ballad","simple","loop_safe"]},{id:"DP057",length_beats:4,type:"beat",pattern:"K-H-S-K-K-H-S-H-",tags:["rock","energetic","loop_safe","variation"]},{id:"DP058",length_beats:4,type:"beat",pattern:"K-S-K-S-K-S-K-S-",tags:["dance","four_on_floor","loop_safe"]},{id:"DP059",length_beats:4,type:"beat",pattern:"K---S-K-K---S---",tags:["syncopation","upbeat","loop_safe"]},{id:"DP060",length_beats:4,type:"beat",pattern:"K-H-S-H-K---S-H-",tags:["rock","variation","loop_safe"]},{id:"DP061",length_beats:4,type:"beat",pattern:"K-K---S-K-K-S---",tags:["dance","syncopation","tense","loop_safe"]},{id:"DP062",length_beats:4,type:"beat",pattern:"K-H-S---K-H-S-K-",tags:["rock","drive","loop_safe","variation"]},{id:"DP063",length_beats:4,type:"beat",pattern:"K-----S---K-S---",tags:["ballad","peaceful","simple","loop_safe"]},{id:"DP064",length_beats:4,type:"beat",pattern:"K-K-S-K-K-K-S-K-",tags:["dance","energetic","drive","loop_safe"]},{id:"DP065",length_beats:4,type:"beat",pattern:"K-H-S-K---H-S-H-",tags:["syncopation","rock","variation","loop_safe"]},{id:"DP066",length_beats:4,type:"beat",pattern:"K---S---K-K-S-K-",tags:["dance","syncopation","build","loop_safe"]},{id:"DP067",length_beats:4,type:"beat",pattern:"K-H-S-H-K-H-S---",tags:["rock","cadence","loop_safe"]},{id:"DP068",length_beats:4,type:"beat",pattern:"K-K-K-K-S-S-S-S-",tags:["experimental","build","tense","loop_safe"]},{id:"DP069",length_beats:4,type:"beat",pattern:"K-HO-K-HO-K-HO-K-HO",tags:["loop_safe","four_on_floor","texture_loop","percussive_layer","variation"]},{id:"DP070",length_beats:4,type:"beat",pattern:"K-HS-K-HK-HS-K-HK-HS",tags:["loop_safe","four_on_floor","grid16","percussive_layer","texture_loop"]},{id:"DP071",length_beats:4,type:"beat",pattern:"K-H-K-S-K-H-O-S-",tags:["loop_safe","four_on_floor","syncopation","percussive_layer","variation"]},{id:"DP072",length_beats:4,type:"beat",pattern:"K-HH-K-S-K-HH-K-S",tags:["loop_safe","four_on_floor","grid16","percussive_layer","build"]},{id:"DP073",length_beats:4,type:"beat",pattern:"KH-HSHKHOHSHKHSH",tags:["loop_safe","grid16","syncopation","breakbeat","percussive_layer"]},{id:"DP074",length_beats:4,type:"beat",pattern:"KH-HSH-KHSOHK-SH",tags:["loop_safe","grid16","syncopation","breakbeat","variation","percussive_layer"]},{id:"DP075",length_beats:4,type:"fill",pattern:"KHSHKHSHKTSHKHSH",tags:["break","breakbeat","drum_fill","grid16","syncopation"]},{id:"DP076",length_beats:4,type:"beat",pattern:"K--H-K--S-H--H--",tags:["loop_safe","swing_hint","simple","rest_heavy","lofi"]},{id:"DP077",length_beats:4,type:"beat",pattern:"K-H--K-HS--H--H-",tags:["loop_safe","swing_hint","rest_heavy","lofi","variation"]},{id:"DP078",length_beats:4,type:"beat",pattern:"K-HS-K-HSK-H-SH-",tags:["loop_safe","grid16","syncopation","breakbeat","percussive_layer"]},{id:"DP079",length_beats:4,type:"beat",pattern:"K-HO-KS-HK-S-HO-",tags:["loop_safe","grid16","syncopation","breakbeat","percussive_layer","variation"]},{id:"DP080",length_beats:4,type:"fill",pattern:"KHSHKHSKTSHKHSS-",tags:["break","breakbeat","drum_fill","grid16","syncopation"]},{id:"DP081",length_beats:4,type:"beat",pattern:"K---H---S-H-----",tags:["loop_safe","swing_hint","rest_heavy","lofi"]},{id:"DP082",length_beats:4,type:"beat",pattern:"K--H---HS--H-K--",tags:["loop_safe","swing_hint","rest_heavy","lofi","variation"]},{id:"DP083",length_beats:4,type:"fill",pattern:"N---S---N---H---",tags:["lofi","drum_fill","rest_heavy","transition"]},{id:"DP084",length_beats:4,type:"beat",pattern:"KHHH-HSHKH-HSHK-",tags:["loop_safe","grid16","syncopation","breakbeat","percussive_layer"]},{id:"DP085",length_beats:4,type:"beat",pattern:"KH-HKHSH-HSHKHSO",tags:["loop_safe","grid16","syncopation","breakbeat","percussive_layer","variation"]},{id:"DP086",length_beats:4,type:"beat",pattern:"K-HHKSH-HK-SHH-H",tags:["loop_safe","grid16","syncopation","breakbeat","percussive_layer"]},{id:"DP087",length_beats:4,type:"beat",pattern:"KHHSHK-HSHK-SHOH",tags:["loop_safe","grid16","syncopation","breakbeat","percussive_layer","variation"]},{id:"DP088",length_beats:4,type:"fill",pattern:"KHSHSHKTSHSHKSH-",tags:["break","breakbeat","drum_fill","grid16","syncopation"]},{id:"DP089",length_beats:4,type:"fill",pattern:"KHSKHSKTSHSKHSKO",tags:["break","breakbeat","drum_fill","grid16","syncopation","variation"]}],ma=[{id:"BP_STEADY_ROOT_DRIVE",texture:"steady",steps:["root","root","fifth","root","fifth","root","fifth","approach"],tags:["default","loop_safe"]},{id:"BP_STEADY_UPWARD_WALK",texture:"steady",steps:["root","fifth","root","octave","fifth","root","octave","approach"],tags:["variation","section_end"]},{id:"BP_BROKEN_TRIAD_LIFT",texture:"broken",steps:["root","fifth","root","octave","root","fifth","root","approach"],tags:["default"]},{id:"BP_BROKEN_PICKUP_DROP",texture:"broken",steps:["root","octave","fifth","octaveHigh","root","fifth","octave","approach"],tags:["variation","pickup","section_end"]},{id:"BP_BREAK_OFFBEAT_DRIVE",texture:"broken",steps:["root","rest","octave","rest","fifth","approach","lowFifth","approach"],tags:["loop_safe","syncopated","breakbeat","variation","default"]},{id:"BP_BREAK_GHOST_RIDE",texture:"broken",steps:["root","octave","rest","fifth","rest","octave","lowFifth","approach"],tags:["loop_safe","breakbeat","syncopated","drive","default"]},{id:"BP_BREAK_SLIDE_UP",texture:"broken",steps:["root","approach","fifth","rest","root","octave","rest","approach"],tags:["loop_safe","breakbeat","variation"]},{id:"BP_LOFI_SWUNG_ROOT",texture:"steady",steps:["root","rest","rest","root","rest","fifth","rest","approach"],tags:["loop_safe","rest_heavy","swing_hint","lofi"]},{id:"BP_LOFI_DUSTY_STEP",texture:"steady",steps:["root","rest","rest","fifth","rest","rest","root","approach"],tags:["loop_safe","lofi","rest_heavy","swing_hint"]},{id:"BP_LOFI_WALKDOWN",texture:"steady",steps:["root","rest","third","rest","second","rest","root","approach"],tags:["loop_safe","lofi","rest_heavy","variation"]},{id:"BP_ARPEGGIO_GLIDE",texture:"arpeggio",steps:["root","octave","fifth","octaveHigh","root","fifth","octave","approach"],tags:["default","loop_safe"]},{id:"BP_ARPEGGIO_PULSE",texture:"arpeggio",steps:["root","fifth","octave","octaveHigh","root","fifth","octave","approach"],tags:["variation","transition","section_end"]},{id:"BP_STEADY_OFFBEAT_PUSH",texture:"steady",steps:["root","fifth","root","approach","fifth","root","octave","approach"],tags:["variation","syncopated","loop_safe"]},{id:"BP_BROKEN_LOW_SWING",texture:"broken",steps:["root","lowFifth","root","fifth","root","lowFifth","root","approach"],tags:["variation","loop_safe"]},{id:"BP_ARPEGGIO_SPREAD",texture:"arpeggio",steps:["root","octave","fifth","octaveHigh","fifth","octave","octaveHigh","approach"],tags:["variation","loop_safe"]},{id:"BP_STEADY_SUB_GRID",texture:"steady",steps:["root","root","root","root","root","root","root","root"],tags:["loop_safe","percussive_layer","four_on_floor","static"]},{id:"BP_STEADY_SUB_OFFSET",texture:"steady",steps:["root","root","root","fifth","root","root","root","approach"],tags:["loop_safe","percussive_layer","variation"]},{id:"BP_FOUR_ON_FLOOR_CLASSIC",texture:"steady",steps:["root","root","root","root","root","fifth","root","root"],tags:["loop_safe","four_on_floor","percussive_layer","static","drone"]},{id:"BP_FOUR_ON_FLOOR_GHOST",texture:"steady",steps:["root","root","fifth","root","root","root","fifth","root"],tags:["loop_safe","four_on_floor","percussive_layer"]},{id:"BP_FOUR_ON_FLOOR_OFFBEAT",texture:"steady",steps:["root","fifth","root","root","root","fifth","root","root"],tags:["loop_safe","four_on_floor","percussive_layer","syncopated"]},{id:"BP_FOUR_ON_FLOOR_OCTAVE_HIT",texture:"steady",steps:["root","root","root","octave","root","root","root","octave"],tags:["loop_safe","four_on_floor","percussive_layer"]},{id:"BP_FOUR_ON_FLOOR_ROLLING",texture:"steady",steps:["root","root","root","fifth","root","root","root","fifth"],tags:["loop_safe","four_on_floor","percussive_layer"]},{id:"BP_DRONE_STATIC_ROOT",texture:"steady",steps:["root","root","root","root","root","fifth","root","approach"],tags:["loop_safe","static","drone","four_on_floor","percussive_layer"]},{id:"BP_DRONE_LOW_PULSE",texture:"steady",steps:["root","lowFifth","root","lowFifth","root","lowFifth","root","lowFifth"],tags:["loop_safe","drone","percussive_layer"]},{id:"BP_DRONE_ACCENT_SPARK",texture:"steady",steps:["root","rest","octave","root","rest","fifth","root","approach"],tags:["loop_safe","drone","accent"]},{id:"BP_TECHNO_BOUNCE",texture:"broken",steps:["root","root","octave","root","root","root","octave","root"],tags:["loop_safe","four_on_floor","percussive_layer"]},{id:"BP_TECHNO_SUB_EMPHASIS",texture:"steady",steps:["root","root","root","lowFifth","root","root","root","lowFifth"],tags:["loop_safe","four_on_floor","percussive_layer"]},{id:"BP_MINIMAL_BREATH",texture:"steady",steps:["root","root","root","root","fifth","root","root","root"],tags:["loop_safe","four_on_floor","percussive_layer","static"]},{id:"BP_WALKING_BASS",texture:"broken",steps:["root","second","third","fifth","root","seventh","octave","approach"],tags:["variation","walking","jazz_hint"]},{id:"BP_OCTAVE_JUMP",texture:"broken",steps:["root","octave","root","octave","fifth","octaveHigh","fifth","approach"],tags:["variation","energetic","jump"]},{id:"BP_CHROMATIC_WALK",texture:"broken",steps:["root","flatSecond","second","third","fifth","sixth","seventh","approach"],tags:["variation","chromatic","tense"]},{id:"BP_SYNCOPATED_GROOVE",texture:"broken",steps:["root","fifth","octave","root","fifth","octave","fifth","approach"],tags:["variation","syncopation","groove"]},{id:"BP_PEDAL_FIFTH",texture:"steady",steps:["root","fifth","root","fifth","root","fifth","root","fifth"],tags:["loop_safe","simple","rock"]},{id:"BP_ARPEGGIO_CASCADE",texture:"arpeggio",steps:["root","third","fifth","octave","fifth","third","root","approach"],tags:["variation","cascade","bright"]},{id:"BP_BOUNCY_RHYTHM",texture:"broken",steps:["root","root","fifth","fifth","octave","octave","fifth","approach"],tags:["variation","playful","bounce"]},{id:"BP_BROKEN_SYNCO_JUMP",texture:"broken",steps:["root","rest","octave","root","fifth","rest","octave","root"],tags:["loop_safe","four_on_floor","percussive_layer","syncopated","default"]},{id:"BP_BROKEN_GRID_PULSE",texture:"broken",steps:["root","root","rest","root","octave","root","rest","root"],tags:["loop_safe","four_on_floor","percussive_layer","grid16"]},{id:"BP_BROKEN_TEXTURE_WAVE",texture:"broken",steps:["root","octave","fifth","root","root","octave","fifth","approach"],tags:["loop_safe","four_on_floor","percussive_layer","texture_loop"]},{id:"BP_BROKEN_DOUBLE_HIT",texture:"broken",steps:["root","root","octave","octave","fifth","fifth","octave","root"],tags:["loop_safe","four_on_floor","percussive_layer"]},{id:"BP_BROKEN_OFFBEAT_DRIVE",texture:"broken",steps:["rest","root","rest","octave","rest","fifth","rest","root"],tags:["loop_safe","four_on_floor","percussive_layer"]},{id:"BP_BROKEN_SUB_BOUNCE",texture:"broken",steps:["root","lowFifth","octave","root","root","lowFifth","octave","root"],tags:["loop_safe","four_on_floor","percussive_layer","static"]},{id:"BP_BROKEN_LIFT_DROP",texture:"broken",steps:["root","fifth","octave","octaveHigh","fifth","root","octave","approach"],tags:["loop_safe","four_on_floor","percussive_layer","variation"]},{id:"BP_BROKEN_STEADY_GRID",texture:"broken",steps:["root","root","root","octave","root","root","root","octave"],tags:["loop_safe","four_on_floor","percussive_layer","default"]}],va={patterns:ma},fa=[{id:"TR_SECTION_NOISE_SWELL",pattern:"N---N---N---NNS-",length_beats:4,tags:["transition","section_end","noise_fx"],channel:"noise"},{id:"TR_SECTION_SNARE_RUSH",pattern:"--S-S-S-S-S-S-S-",length_beats:4,tags:["transition","section_end","drum_fill"],channel:"noise"},{id:"TR_LOOP_TIGHTENER",pattern:"K-HS-HK-HS-HK-H-",length_beats:4,tags:["transition","loop_out","drum_fill"],channel:"noise"},{id:"TR_SECTION_GHOST_ECHO",pattern:"N---S---N---S---",length_beats:4,tags:["transition","section_end","loop_out","noise_fx"],channel:"noise"},{id:"TR_BUILD_STUTTER_FILL",pattern:"K-SK-SK-SK-SK-S-",length_beats:4,tags:["transition","build","drum_fill"],channel:"noise"},{id:"TR_BREAKBEAT_SNARE_CHOP",pattern:"S--S-HS-S-HS-S--",length_beats:4,tags:["transition","section_end","break","breakbeat","drum_fill"],channel:"noise"},{id:"TR_LOFI_TAPE_SWELL",pattern:"N---H---S---H---",length_beats:4,tags:["transition","section_end","lofi","noise_fx","rest_heavy"],channel:"noise"}],ya={transitions:fa},_a=ca,Ma=pa,ba=ha,Sa=ga,Ra=va,xa=ya,ut=_a,se=Ma,je=new Map(se.map(a=>[a.id,a])),dt=ba,$e=new Map(dt.map(a=>[a.id,a])),re=Sa,Pa=new Map(re.map(a=>[a.id,a])),Ea=Ra.patterns??[],ze=Ea.reduce((a,e)=>{const t=a.get(e.texture)??[];return t.push(e),a.set(e.texture,t),a},new Map),ve=xa.transitions??[],xe=["root","root","fifth","root","fifth","root","fifth","approach"],Ba={id:"BP_FALLBACK_STEADY",texture:"steady",steps:xe,tags:["fallback"]},Ta={upbeat:["straight","syncopation"],sad:["straight","simple"],tense:["syncopation","accented"],peaceful:["straight","open"]},Ha={upbeat:["bright","ascending"],sad:["dark","descending"],tense:["dark","complex","leaping"],peaceful:["simple","arch","bright"]},Ia={upbeat:["syncopated","drive"],sad:["legato","rest_heavy"],tense:["syncopated","staccato"],peaceful:["legato","simple"]},Z=new Map(ut.map(a=>[a.id,a])),Ka={dualBass:{preferBeatTags:["percussive_layer","syncopation"],preferFillTags:["drum_fill","build"]},bassLed:{preferBeatTags:["four_on_floor","drive"],preferFillTags:["build"],earlySparseMeasures:1},layeredBass:{preferBeatTags:["four_on_floor","loop_safe"],preferFillTags:["drum_fill"]},minimal:{preferBeatTags:["simple","open"],preferFillTags:["noise_fx"],avoidTags:["build","drive"],earlySparseMeasures:2},breakLayered:{preferBeatTags:["breakbeat","percussive_layer","grid16"],preferFillTags:["break","drum_fill","breakbeat"],avoidTags:["four_on_floor"]},lofiPadLead:{preferBeatTags:["lofi","rest_heavy","swing_hint"],preferFillTags:["noise_fx","lofi"],avoidTags:["breakbeat"],earlySparseMeasures:2},retroPulse:{preferBeatTags:["loop_safe","grid16","syncopation"],preferFillTags:["build","transition"],avoidTags:["rest_heavy"]}},Oa={dualBass:{density:.85,velocityScale:.9,offbeatAccentBoost:3},bassLed:{density:.6,sustainWholeMeasure:!1,offbeatAccentBoost:5},layeredBass:{density:.75,velocityScale:.95},minimal:{density:.5,sustainWholeMeasure:!0,velocityScale:.8},breakLayered:{density:.95,velocityScale:1.05,offbeatAccentBoost:6},lofiPadLead:{density:.55,sustainWholeMeasure:!0,velocityScale:.7},retroPulse:{density:.78,velocityScale:.95,offbeatAccentBoost:2}};function S(a,e,t=.4){if(!e.length)return a;const n=a.filter(s=>{const r=s.tags??[];return e.some(i=>r.includes(i))});return n.length===0||a.length>=4&&n.length<a.length*t?a:n}function Ye(a,e){const t=[...a];for(let n=t.length-1;n>0;n--){const s=Math.floor(e()*(n+1)),r=t[n];t[n]=t[s],t[s]=r}return t}function ct(a,e,t,n=.6){if(!e.length||a.length<=1)return a;const s=a.filter(d=>{const c=d.tags??[];return e.some(h=>c.includes(h))});if(!s.length||s.length===a.length)return a;const r=a.filter(d=>!s.includes(d)),i=Ye(s,t),o=Ye(r,t),l=Math.min(i.length,Math.max(1,Math.ceil(a.length*n))),u=i.slice(0,l),p=[...i.slice(l),...o];return[...u,...p]}const ee=1337;function pe(a){let e=(a??ee)>>>0;return e===0&&(e=ee),()=>(e=e*1664525+1013904223>>>0,e/4294967295)}function D(a,e,t){if(!a.length)throw new Error("No candidates available for selection");if(a.length===1)return a[0];let n=a[Math.floor(e()*a.length)];if(t&&a.length>1){let s=0;for(;(n==null?void 0:n.id)===t&&s<3;)n=a[Math.floor(e()*a.length)],s++}return n}function C(a,e){return e.length?e.every(t=>a.tags.includes(t)):!0}function Aa(a){return Math.abs(a%1)<1e-6}function Fa(a,e){return e.find(t=>a>=t.startBeat&&a<t.startBeat+t.durationBeats)}function pt(a,e){return a===0?"start":a===e-1?"end":"middle"}function ka(a){try{return ft(a),!0}catch{return!1}}function ht(a,e,t,n,s,r,i){var o;const l=ut.filter(ka),u=Ta[a.mood]??[],p=(v,m)=>v.filter(f=>m.some(y=>f.tags.includes(y))),d=l.filter(v=>C(v,s));let c=l.filter(v=>v.tags.includes(t));const h=p(c,u);if(h.length)c=h;else{const v=p(l,u);v.length&&(c=v)}if(e.loopCentric&&(c=S(c,["loop_safe","texture_loop"])),e.textureFocus&&(c=S(c,["texture_loop","straight","simple","grid16"])),e.percussiveLayering&&(c=S(c,["grid16","percussive_layer"])),e.syncopationBias&&(c=S(c,["syncopation"])),c.length||(c=l),s.length){const v=c.filter(m=>C(m,s));v.length?c=v:d.length&&(c=d)}if((o=n==null?void 0:n.variations)!=null&&o.length){const v=n.variations.map(m=>Z.get(m)).filter(m=>!!m);if(v.length&&r()<.5){const m=w(v,i);return D(m,r,n.id)}}const g=w(c,i);return D(g,r,n==null?void 0:n.id)}function Da(a,e,t,n,s,r){const i=Ha[a.mood]??[];let o=se.filter(u=>i.some(p=>u.tags.includes(p)));if(t.length){const u=o.filter(p=>C(p,t));if(u.length)o=u;else{const p=se.filter(d=>C(d,t));p.length&&(o=p)}}o.length||(o=se),e.textureFocus&&(o=S(o,["texture_loop","ostinato","loop_safe","short","static"])),e.harmonicStatic&&(o=ct(o,["scalar","stepwise","static"],n,.6)),e.gradualBuild&&(o=S(o,["ascending"]));const l=w(o,r);return D(l,n,s==null?void 0:s.id)}function Ca(a,e,t,n,s,r,i,o){const l=Ia[a.mood]??[];let u=dt.filter(h=>Math.abs(h.length-n)<1e-6);if(!u.length)throw new Error(`No melody rhythm motifs of length ${n}`);let p=u.filter(h=>h.tags.includes(t));p.length||(p=u);let d=p.filter(h=>l.some(g=>h.tags.includes(g)));if(d.length||(d=p),e.loopCentric&&(d=S(d,["loop_safe","texture_loop"])),e.textureFocus&&(d=S(d,["texture_loop","grid16","simple"])),e.syncopationBias&&(d=S(d,["syncopated","drive"])),s.length){const h=d.filter(g=>C(g,s));h.length&&(d=h)}d=Xa(d,n);const c=w(d,o);return D(c,r,i)}function wa(a,e,t,n,s){let r={broken:90,steady:86,arpeggio:92}[a.texture]??88;const i=e===0?6:0,o=a.measures-e<=1?4:0;if(s.textureFocus&&(r-=8),s.gradualBuild){const l=n>1?t/Math.max(1,n-1):0,u=Math.min(1,Math.max(0,l)),p=n<=16?.6:n<=32?.75:.9,d=Math.pow(u,p),c=n<=16?14:n<=32?18:20,h=Math.floor(d*c);r+=h}return s.loopCentric&&(r=Math.max(60,r-2)),Math.min(110,Math.max(58,r+i+o))}function La(a,e,t,n,s){const r={upbeat:0,peaceful:-3,tense:-5,sad:-2},i={slow:-2,medium:0,fast:2},o={minimalTechno:-4,progressiveHouse:3,retroLoopwave:2,breakbeatJungle:-2,lofiChillhop:-5},l=(n.textureFocus?2:0)+(n.gradualBuild?1:0)+(n.loopCentric?-1:0)+(n.atmosPad?2:0)+(n.percussiveLayering?-2:0),u=r[a]??0,p=i[e]??0,d=t?o[t]??0:0,c=pe(s),h=Math.floor(c()*7)-3,g=72+u+p+d+l+h;return Math.max(63,Math.min(78,g))}function Na(a,e,t,n,s,r){if(!a)return r;const i={steady:0,broken:-3,arpeggio:4},o=Math.max(0,e);let l=i[a.texture]??0;if(s.textureFocus&&(l-=4),s.filterMotion&&(l+=1),ue(a)&&o===0&&(l+=3),k(a)&&o===0&&(l-=2),s.gradualBuild){const h=t/Math.max(1,n-1),g=Math.round(Math.pow(h,.7)*8);l+=g}(a.measures>0?o/a.measures:0)>=.75&&(l-=2);const u=Math.min(a.occurrenceIndex-1,2)*2;l-=u,s.atmosPad&&(l-=1);const p=60,d=84,c=r+l;return Math.max(p,Math.min(d,c))}function Ga(a,e,t,n){if(e<=0)return;const s=e-.25;if(s<0)return;const r=t.pattern,i=r[r.length-1]??r[0]??1;a.push({channelRole:"melody",startBeat:s,durationBeats:.25,degree:i,velocity:da.PICKUP_BASE,sectionId:n})}function qa(a,e,t,n){if(!e.length)return a;const s=[e[e.length-1]],r=s[0]+(t.textureFocus?2:1),i=s[0]-(t.loopCentric?1:2),o=new Set([a,s[0],r,i]),l=Array.from(o);return l[Math.floor(n()*l.length)]}function Je(a,e,t,n,s){const r=a.variations??[];if(!r.length)return;const i=r.map(l=>Z.get(l)).filter(l=>!!l).filter(l=>l.tags.includes(e)&&C(l,t));if(!i.length)return;const o=w(i,s);return D(o,n,a.id)}function Ua(a,e,t,n,s){var r;const i=(r=s.steps)!=null&&r.length?s.steps:xe,o=[],l=de(t,40),u=n??t;for(let p=0;p<i.length;p++){const d=e+p*.5,c=vt(i[p],t,u,l);c!==null&&o.push({channelRole:"bass",startBeat:d,durationBeats:.5,degree:0,velocity:mt(a,p),sectionId:a.id,midiOverride:c})}return o}function gt(a,e,t,n,s,r,i){const o=(i==null?void 0:i.enforceDroneStatic)??!0,l=(i==null?void 0:i.preferredTags)??[],u=e===a.measures-1,p=s.get(a.id);if(p){if(u&&!(p.tags??[]).includes("section_end")){const h=q(a.texture,r,t,n,["section_end"],p.id);if(h)return n.add(h.id),h}return p}if(r.harmonicStatic){if(!o&&l.length){const g=q(a.texture,r,t,n,l,void 0);if(g)return s.set(a.id,g),n.add(g.id),g}const h=q(a.texture,r,t,n,["drone","static"],void 0);if(h&&o)return s.set(a.id,h),n.add(h.id),h}const d=ue(a)?["pickup"]:[],c=q(a.texture,r,t,n,d,void 0)??q(a.texture,r,t,n,[],void 0)??Ba;if(s.set(a.id,c),n.add(c.id),u&&!(c.tags??[]).includes("section_end")){const h=q(a.texture,r,t,n,["section_end"],c.id);if(h)return n.add(h.id),h}return c}function q(a,e,t,n,s,r){let i=ze.get(a)??[];if(!i.length&&a!=="steady"&&(i=ze.get("steady")??[]),!i.length)return;if((e.loopCentric||e.harmonicStatic)&&(i=S(i,["loop_safe"])),e.syncopationBias&&(i=S(i,["syncopated"])),e.textureFocus&&(i=S(i,["default"])),e.percussiveLayering&&(i=S(i,["percussive_layer","four_on_floor"])),e.percussiveLayering&&e.syncopationBias&&e.breakInsertion&&(i=S(i,["breakbeat","variation"],.2)),e.atmosPad&&e.loopCentric&&(i=S(i,["lofi","rest_heavy"],.25)),e.harmonicStatic&&(i=ct(i,["drone","static"],t,.65)),s.length){const l=i.filter(u=>s.every(p=>(u.tags??[]).includes(p)));l.length&&(i=l)}if(!i.length)return;const o=w(i,n);return D(o,t,r)}function Va(a,e){const t=[];for(const n of e){let s=n.startBeat,r=0;const i=4;for(;r<i&&a.some(o=>Math.abs(o.startBeat-s)<.0625);)r++,s=n.startBeat+r*.0625;t.push({...n,startBeat:s})}return t}function Wa(a,e,t,n,s,r,i,o,l){if(!ve.length)return;const u=["transition","section_end"];t&&u.push("loop_out");let p=ve.filter(f=>f.length_beats<=_);p.length||(p=ve);const d=l>1?o/Math.max(1,l-1):0,c=[];if(i.gradualBuild&&(d<.4?c.push("build"):d<.8?c.push("drum_fill"):c.push("loop_out")),i.breakInsertion&&d>=.5&&c.push("noise_fx"),i.percussiveLayering&&c.push("drum_fill"),c.length&&(p=S(p,c,.2)),u.length){const f=p.filter(y=>C(y,u));f.length&&(p=f)}if(!p.length)return;const h=w(p,r),g=D(h,n,s);if(!g)return;const v=g.length_beats>=_?e:e+Math.max(0,_-g.length_beats),m=lt(g.pattern,v,a.id);return{motifId:g.id,hits:m}}function mt(a,e){const t=Ue[a.texture]??Ue.default;return e===0?t+Ve.DOWNBEAT_BOOST:e%4===0?t+Ve.STRONG_BEAT_BOOST:t}function vt(a,e,t,n){switch(a){case"root":return B(n,e);case"fifth":return B(n+7,e);case"lowFifth":return B(n-5,e);case"octave":return B(n+12,e);case"octaveHigh":return B(n+19,e);case"approach":{const s=de(t,n+5);return B(s-1,t)}case"rest":return null;default:return B(n,e)}}function ft(a){const e=a.pattern.map(n=>({durationBeats:Ee(n)})),t=e.reduce((n,s)=>n+s.durationBeats,0);if(Math.abs(t-a.length)>1e-6)throw new Error(`Rhythm motif ${a.id} length mismatch. expected=${a.length}, got=${t}`);return e}function ja(a,e,t){if(a==="steady"){const n=[1,5];return n[Math.floor(t/2)%n.length]}else{const n=[1,3,5,7];return n[e%n.length]}}function $a(a,e){return 58+(a==="start"&&e===0?6:0)}function za(a,e,t,n,s,r,i){const o=[],l=ft(t);let u=0,p=0;const d=Oa[r];for(let c=0;c<l.length;c++){const h=l[c];if(u>=_)break;const g=_-u,v=Math.min(h.durationBeats,g),m=ja(a.texture,p,u),f=u%1>1e-6;let y=$a(s,u);if(d!=null&&d.velocityScale&&(y=Math.round(y*d.velocityScale)),f&&d!=null&&d.offbeatAccentBoost&&(y+=d.offbeatAccentBoost),(d==null?void 0:d.density)!==void 0&&d.density<1){const b=Math.max(0,Math.min(1,d.density));if(i()>b){u+=v,p++;continue}}if(o.push({channelRole:"accompaniment",startBeat:e+u,durationBeats:v,degree:m,velocity:y,sectionId:a.id}),u+=v,p++,u>=_)break}if(s==="start"&&ue(a)&&n.pattern.length&&e>=.5&&!((d==null?void 0:d.density)!==void 0&&d.density<.5)){const c=n.pattern[0];o.push({channelRole:"accompaniment",startBeat:Math.max(0,e-.5),durationBeats:.5,degree:c,velocity:A.EARLY_START,sectionId:a.id})}if(d!=null&&d.sustainWholeMeasure&&o.length){const c=o[0].degree,h=Math.max(A.PAD_MIN,Math.round(o.reduce((g,v)=>g+v.velocity,0)/o.length));return[{channelRole:"accompaniment",startBeat:e,durationBeats:_,degree:c,velocity:h,sectionId:a.id}]}return o}function Ya(a){const e=a.pattern.map(n=>({durationBeats:Ee(n.value),rest:!!n.rest,accent:n.accent})),t=e.reduce((n,s)=>n+s.durationBeats,0);if(Math.abs(t-a.length)>1e-6)throw new Error(`Melody rhythm motif ${a.id} length mismatch. expected=${a.length}, got=${t}`);return e}function Ja(a,e){const t=a.pattern??[];if(!t.length)return!1;const n=e>=4?.25:0;let s=0,r=!1,i=0;for(const o of t){const l=Ee(o.value);if(o.rest){s+=l,i=0;continue}if(l>=.5){r=!0,i=0;continue}if(i+=l,i>1+1e-6)return!1}return s>=n?!0:r}function Xa(a,e){const t=a.filter(n=>Ja(n,e));return t.length?t:a}function Pe(a,e,t){a.has(e)||a.set(e,new Map);const n=a.get(e);return n.has(t)||n.set(t,{}),n.get(t)}function Qa(a,e,t,n){const s=a.get(e);if(!(!s||s.size===0))return s.get(1)}function Za(a,e,t,n){a.has(e)||a.set(e,new Map);const s=a.get(e);t===1&&s.set(t,n)}function en(a,e){const t=pe(a.seed),n=a.seed??Date.now(),s=La(a.mood,a.tempo,a.stylePreset,e.styleIntent,n);return{rng:t,compositionBaseRegister:s,sectionById:new Map(e.sections.map(r=>[r.id,r])),styleIntent:e.styleIntent,voiceArrangement:e.voiceArrangement,totalMeasures:a.lengthInMeasures,usedMotifs:{rhythms:new Set,melodies:new Set,drums:new Set,melodyRhythms:new Set,bassPatterns:new Set,transitions:new Set},caches:{template:new Map,hook:new Map,bassPattern:new Map},lastMotifs:{},motifUsage:{rhythm:{},melody:{},drums:{},melodyRhythm:{},bass:{},transitions:{}}}}function tn(a,e,t,n,s){a.startMeasure*_;const r=Math.max(1,$t(a));let i=0;for(;i<a.measures;){const o=Math.min(r,a.measures-i),l=i===0,u=a.startMeasure+i,p=an(a,e,t,o,l,u,n,s);nn(p,e,t,n,s),i+=o}}function an(a,e,t,n,s,r,i,o){const l=Qa(i.caches.hook,a.templateId,a.occurrenceIndex,i.rng),u=pt(0,a.measures),p=[];r===i.totalMeasures-1?p.push("loop_safe"):r===i.totalMeasures-2&&!(k(a)&&s)&&p.push("cadence");let d,c,h;const g=oe(u,p);oe(u,p);const v=Pe(i.caches.template,a.templateId,g);if(k(a)&&s&&l){const m=Z.get(l.rhythmId),f=je.get(l.melodyId);m&&(d=m),f&&(c=f)}if(!d){const m=v.rhythm;d=m?Z.get(m):void 0,d||(d=ht(t,i.styleIntent,u,i.lastMotifs.rhythm,p,i.rng,i.usedMotifs.rhythms),v.rhythm=d.id)}if(!c){const m=v.melody;c=m?je.get(m):void 0,c||(c=Da(t,i.styleIntent,p,i.rng,i.lastMotifs.melodyFragment,i.usedMotifs.melodies),v.melody=c.id)}if(k(a)&&s&&l){const m=$e.get(l.melodyRhythmId);m&&(h=m)}if(!h){const m=v.melodyRhythm;h=m?$e.get(m):void 0,h||(h=Ca(t,i.styleIntent,u,n*_,p,i.rng,void 0,i.usedMotifs.melodyRhythms),v.melodyRhythm=h.id)}return ue(a)&&s&&Za(i.caches.hook,a.templateId,a.occurrenceIndex,{rhythmId:d.id,melodyId:c.id,melodyRhythmId:h.id}),i.usedMotifs.rhythms.add(d.id),i.usedMotifs.melodies.add(c.id),i.usedMotifs.melodyRhythms.add(h.id),i.motifUsage.melodyRhythm[h.id]=(i.motifUsage.melodyRhythm[h.id]??0)+1,s&&o.sectionMotifPlan.push({sectionId:a.id,templateId:a.templateId,occurrenceIndex:a.occurrenceIndex,primaryRhythm:d.id,primaryMelody:c.id,primaryMelodyRhythm:h.id,reprisesHook:k(a)&&!!l&&(l==null?void 0:l.rhythmId)===d.id&&(l==null?void 0:l.melodyId)===c.id&&(l==null?void 0:l.melodyRhythmId)===h.id}),{section:a,phraseMeasures:n,isFirstPhrase:s,phraseStartMeasureIndex:r,cachedHook:l,baseRhythm:d,baseMelody:c,baseMelodyRhythm:h}}function nn(a,e,t,n,s){const{section:r,phraseMeasures:i,isFirstPhrase:o,baseMelody:l,baseMelodyRhythm:u}=a;r.startMeasure*_;const p=Ya(u);let d=0,c=0,h=0;for(let g=0;g<i;g++){const v=sn(a,g,t,n);o&&g===0&&Ga(s.melody,v.measureStartBeat,l,r.id),rn(v,p,l,r,n,s.melody,{phraseBeatCursor:d,phraseStepIndex:c,melodyDegreeCursor:h});const m=(g+1)*_;for(;c<p.length&&d<m;){const f=p[c];f.rest||h++,d+=f.durationBeats,c++}on(v,e,r,n,s.bass),ln(v,l,r,n,s.accompanimentSeeds),un(v,r,n,s.drums),n.lastMotifs.rhythm=v.rhythmMotif,n.lastMotifs.melodyFragment=l}}function sn(a,e,t,n){const{section:s,isFirstPhrase:r,baseRhythm:i}=a,o=a.phraseStartMeasureIndex-s.startMeasure+e,l=s.startMeasure+o,u=s.startMeasure*_+o*_,p=pt(o,s.measures),d=[],c=k(s)&&o===0;l===n.totalMeasures-1?d.push("loop_safe"):l===n.totalMeasures-2&&!c&&d.push("cadence");const h=oe(p,d),g=Pe(n.caches.template,s.templateId,h),v=t.sectionRepeatBias??.3,m=e>0||!r||s.occurrenceIndex>1,f=!k(s)&&m&&n.rng()>v;let y=g.rhythm?Z.get(g.rhythm):void 0;if(!y)f?y=Je(i,p,d,n.rng,n.usedMotifs.rhythms)??i:y=i;else if(f&&y.id===i.id){const b=Je(i,p,d,n.rng,n.usedMotifs.rhythms);b&&(y=b)}return(!y.tags.includes(p)||!C(y,d))&&(y=ht(t,n.styleIntent,p,i,d,n.rng,n.usedMotifs.rhythms)),g.rhythm=y.id,n.motifUsage.rhythm[y.id]=(n.motifUsage.rhythm[y.id]??0)+1,n.usedMotifs.rhythms.add(y.id),{measureInSection:o,globalMeasureIndex:l,measureStartBeat:u,functionTag:p,requiredTags:d,isHookMeasure:c,phraseOffset:e,rhythmMotif:y}}function rn(a,e,t,n,s,r,i){const{measureStartBeat:o,measureInSection:l,globalMeasureIndex:u,phraseOffset:p}=a,d=(p+1)*_;for(;i.phraseStepIndex<e.length&&i.phraseBeatCursor<d;){const c=e[i.phraseStepIndex],h=i.phraseBeatCursor-p*_;if(!c.rest){let g=t.pattern[i.melodyDegreeCursor%t.pattern.length];i.phraseStepIndex===e.length-1&&(n.occurrenceIndex>1||l>0)&&!k(n)&&(g=qa(g,t.pattern,s.styleIntent,s.rng));let v=wa(n,l,u,s.totalMeasures,s.styleIntent);r.push({channelRole:"melody",startBeat:o+h,durationBeats:c.durationBeats,degree:g,velocity:v,sectionId:n.id}),i.melodyDegreeCursor++}i.phraseBeatCursor+=c.durationBeats,i.phraseStepIndex++}}function on(a,e,t,n,s){const{measureStartBeat:r,measureInSection:i}=a;let o=n.caches.bassPattern.get(t.id);o||(o=gt(t,i,n.rng,n.usedMotifs.bassPatterns,n.caches.bassPattern,n.styleIntent),n.caches.bassPattern.set(t.id,o));const l=I(e,r),u=I(e,r+_);s.push(...Ua(t,r,l,u,o))}function ln(a,e,t,n,s){const{measureStartBeat:r,rhythmMotif:i,functionTag:o}=a;s.push(...za(t,r,i,e,o,n.voiceArrangement.id,n.rng))}function un(a,e,t,n){var s;const{measureStartBeat:r,measureInSection:i,requiredTags:o}=a,l=i===e.measures-1,u=l||e.measures>2&&i===e.measures-2,p=oe(`${i}:${u?"fill":"beat"}`,o),d=Pe(t.caches.template,e.templateId,p);let c=d.drum?Pa.get(d.drum):void 0;if(c||(c=mn(i,e.measures,o,t.rng,t.lastMotifs.drumPatternId,t.usedMotifs.drums,u,t.styleIntent,t.voiceArrangement.id),c&&(d.drum=c.id)),c&&(t.motifUsage.drums[c.id]=(t.motifUsage.drums[c.id]??0)+1,t.usedMotifs.drums.add(c.id),n.push(...lt(c.pattern,r,e.id)),t.lastMotifs.drumPatternId=c.id),l){const h=e.id===((s=t.sectionById.get(Array.from(t.sectionById.keys()).pop()))==null?void 0:s.id),g=Wa(e,r,h,t.rng,t.lastMotifs.transitionId,t.usedMotifs.transitions,t.styleIntent,e.startMeasure+i,t.totalMeasures);g&&(t.motifUsage.transitions[g.motifId]=(t.motifUsage.transitions[g.motifId]??0)+1,t.usedMotifs.transitions.add(g.motifId),n.push(...Va(n,g.hits)),t.lastMotifs.transitionId=g.motifId)}}function dn(a,e,t){return a.map(n=>{const s=t.sectionById.get(n.sectionId),r=Math.floor(n.startBeat/_),i=s?r-s.startMeasure:0,o=Na(s,i,r,t.totalMeasures,t.styleIntent,t.compositionBaseRegister),l=ce(n.degree,e.scaleDegrees,o),u=I(e,n.startBeat),p=Aa(n.startBeat)?B(l,u):Q(l,u);return{...n,midi:p}})}function cn(a,e,t){return a.map(n=>{const s=ce(n.degree,e.scaleDegrees,67),r=I(e,n.startBeat),i=Fa(n.startBeat,t),o=Q(s,r,i==null?void 0:i.midi);return{...n,midi:o}})}function pn(a,e){return a.map(t=>{const n=t.midiOverride??ce(t.degree,e.scaleDegrees,52,-1),s=I(e,t.startBeat),r=B(n,s);return{...t,midi:r}})}function hn(a,e){const t=en(a,e),n={melody:[],bass:[],accompanimentSeeds:[],drums:[],sectionMotifPlan:[]};for(const o of e.sections)tn(o,e,a,t,n);const s=dn(n.melody,e,t),r=pn(n.bass,e),i=cn(n.accompanimentSeeds,e,s);return{melody:s,bass:r,accompanimentSeeds:i,drums:n.drums,motifUsage:t.motifUsage,sectionMotifPlan:n.sectionMotifPlan}}function gn(a,e){const{voiceArrangement:t}=e,n=a.seed??ee,s=hn(a,e);if(t.id==="standard"||t.id==="swapped")return{tracks:[{role:"melody",notes:s.melody},{role:"bass",notes:s.bass},{role:"accompaniment",notes:s.accompanimentSeeds}],drums:s.drums,motifUsage:s.motifUsage,sectionMotifPlan:s.sectionMotifPlan};const r=[];for(const i of t.voices){let o;switch(i.role){case"bass":case"bassAlt":o=yn(i.role,i.priority,i.octaveOffset??0,i.seedOffset??0,a,e);break;case"pad":o=_n(i.priority,a,e,n+(i.seedOffset??0));break;case"melody":case"melodyAlt":case"accompaniment":if(i.role==="melody"&&t.id==="minimal")continue;i.role==="melody"?o=s.melody:o=s.accompanimentSeeds;break;default:o=[]}const l=o.map(u=>{let p,d=u.velocity;if((u.channelRole==="bass"||i.role==="bass"||i.role==="bassAlt")&&u.midiOverride!==void 0)p=u.midiOverride;else{Math.floor(u.startBeat/_);const c=i.role==="melody"||i.role==="melodyAlt"?72:67,h=ce(u.degree,e.scaleDegrees,c),g=I(e,u.startBeat);p=B(h,g),i.octaveOffset&&(p+=i.octaveOffset*12)}return t.id==="layeredBass"&&(i.role==="bass"?d=Math.max(28,Math.round(d*.65)):i.role==="bassAlt"&&(d=Math.max(22,Math.round(d*.5)))),{...u,midi:p,velocity:d}});l.length>0&&r.push({role:i.role,notes:l})}return{tracks:r,drums:s.drums,motifUsage:s.motifUsage,sectionMotifPlan:s.sectionMotifPlan}}function Ee(a){switch(a){case 2:return 2;case 4:return 1;case 8:return .5;case 16:return .25;default:return .25}}function mn(a,e,t,n,s,r,i,o,l){var u,p,d;const c=Ka[l];if(!i&&c!=null&&c.earlySparseMeasures&&a<c.earlySparseMeasures&&n()<.3)return;if(o.gradualBuild&&e>=8){const R=a/Math.max(1,e-1),z=Math.min(.35,6/Math.max(1,e)),L=Math.min(.7,14/Math.max(1,e));if(R<z){if(n()<.75)return}else if(R<L&&n()<.35)return}const h=o.breakInsertion?2:4,g=h>0&&e>=h&&(a+1)%h===0,v=i||g;let m=re.filter(R=>v?R.type==="fill":R.type==="beat");const f=m.filter(R=>R.length_beats<=_);if(f.length&&(m=f),t.length){const R=m.filter(z=>{const L=z.tags;return L?t.every(ge=>L.includes(ge)):!1});R.length&&(m=R)}m.length||(m=re.filter(R=>v?R.type==="fill":R.type==="beat")),m.length||(m=re);const y=o.percussiveLayering&&o.syncopationBias&&o.breakInsertion&&!o.loopCentric,b=o.atmosPad&&o.loopCentric&&o.harmonicStatic,x=o.loopCentric&&o.textureFocus&&o.percussiveLayering;if(v?(p=c==null?void 0:c.preferFillTags)!=null&&p.length&&(m=S(m,c.preferFillTags,.25)):(o.loopCentric&&(m=S(m,["loop_safe"])),o.syncopationBias&&(m=S(m,y?["breakbeat","syncopation","grid16"]:["syncopation"])),o.textureFocus&&(m=S(m,["texture_loop","straight","grid16"])),o.percussiveLayering&&(m=S(m,y?["breakbeat","percussive_layer","grid16"]:["percussive_layer","four_on_floor"])),b&&(m=S(m,["lofi","rest_heavy","swing_hint"],.3)),x&&(m=S(m,["loop_safe","grid16","texture_loop"],.25)),(u=c==null?void 0:c.preferBeatTags)!=null&&u.length&&(m=S(m,c.preferBeatTags,.25))),y&&(m=S(m,["breakbeat","grid16"],.2)),(d=c==null?void 0:c.avoidTags)!=null&&d.length){const R=m.filter(z=>{const L=z.tags;return L?!c.avoidTags.some(ge=>L.includes(ge)):!0});R.length&&(m=R)}const F=w(m,r);return D(F,n,s)}function w(a,e){if(!a.length)return a;const t=a.filter(n=>n.id?!e.has(n.id):!0);return t.length?t:a}function oe(a,e){if(!e.length)return a;const t=[...e].sort();return`${a}:${t.join("|")}`}function vn(a,e){const t=(a??ee)+e>>>0;return pe(t)}function yt(a,e,t,n,s){if(a>=1)return!0;if(n.gradualBuild){const r=e/Math.max(1,t-1),i=Math.min(1,a+r*.3);return s()<i}return s()<a}function fn(a,e,t,n,s,r,i=0){var o;const l=(o=s.steps)!=null&&o.length?s.steps:xe,u=[],p=n??t;for(let d=0;d<l.length;d++){const c=e+d*.5,h=vt(l[d],t,p,r);h!==null&&u.push({channelRole:"bass",startBeat:c,durationBeats:.5,degree:0,velocity:mt(a,d),sectionId:a.id,midiOverride:h})}return u}function yn(a,e,t,n,s,r){const i=[],o=r.styleIntent,l=s.seed??ee,u=vn(l,n),p=new Set,d=new Map,c=40+t*12;for(const h of r.sections){const g=h.startMeasure*_;for(let v=0;v<h.measures;v++){if(!yt(e,v,h.measures,o,u))continue;const m=g+v*_,f=gt(h,v,u,p,d,o,a==="bassAlt"?{enforceDroneStatic:!1,preferredTags:["drone","accent"]}:void 0),y=I(r,m),b=I(r,m+_),x=fn(h,m,y,b,f,c,t);i.push(...x)}}return i}function _n(a,e,t,n){const s=pe(n),r=[];for(const i of t.sections){const o=i.startMeasure*_;for(let l=0;l<i.measures;l++){if(!yt(a,l,i.measures,t.styleIntent,s))continue;const u=o+l*_,p=l%2===0?1:5;r.push({channelRole:"accompaniment",startBeat:u,durationBeats:_,degree:p,velocity:A.PAD_MIN,sectionId:i.id})}}return r}const Mn=42,bn=.5,Sn=.015,Rn=.12,Xe=1/16,xn={K:{mode:"long",spec:"long_period",periodIndex:3,releaseRange:[.045,.075],velocity:G.KICK,amplitude:1},T:{mode:"long",spec:"long_period",periodIndex:5,releaseRange:[.05,.09],velocity:G.TOM,amplitude:.92},N:{mode:"long",spec:"long_period",periodIndex:8,releaseRange:[.06,.1],velocity:G.LOW_NOISE,amplitude:.88},S:{mode:"short",spec:"short_period",periodIndex:1,releaseRange:[.02,.045],velocity:G.SNARE,amplitude:.9},H:{mode:"short",spec:"short_period",periodIndex:0,releaseRange:[.015,.03],velocity:G.HIHAT,amplitude:.86},O:{mode:"short",spec:"short_period",periodIndex:2,releaseRange:[.03,.055],velocity:G.OPEN_HAT,amplitude:.94}},Pn=5,En=.06;function Bn(a){let e=a;return()=>(e=(e*1664525+1013904223)%4294967296,e/4294967296)}function Be(a,e,t,n){let s=1;const r=e==="bass"||e==="bassAlt",i=a==="square1"||a==="square2";r&&(s*=J.BASS_BASE,t<ua.BASS_LOW_RANGE&&(s*=J.BASS_LOW_RANGE)),a==="triangle"&&(s*=J.TRIANGLE_BASE,r||(s*=J.TRIANGLE_NON_BASS)),i&&r&&(s*=J.SQUARE_BASS);const o=Math.round(n*s);return Math.max(qe.MIN,Math.min(qe.MAX_ACCENT,o))}function Tn(a,e){const t={reverseProbability:.5,sustainProbability:.2,densityThresholds:{sparse:.45,normal:.85}};return a.textureFocus&&(t.reverseProbability=.35,t.sustainProbability=.12,t.densityThresholds={sparse:.3,normal:.7}),a.loopCentric&&(t.sustainProbability=Math.min(.35,t.sustainProbability+.1),t.densityThresholds={sparse:Math.min(.5,t.densityThresholds.sparse+.05),normal:Math.min(.95,t.densityThresholds.normal+.05)}),e==="arpeggio"&&a.gradualBuild&&(t.densityThresholds={sparse:.25,normal:.65}),t}function Hn(a,e,t,n,s){const r=Math.abs(e.midi-a.midi),i=e.startBeat-(a.startBeat+t),o=r>0&&r<=Pn,l=i>=-.001&&i<=.5,u=t>=.5;if(!o||!l||!u)return!1;let p=.15;return n.atmosPad?p=.4:n.loopCentric&&n.textureFocus?p=.35:n.gradualBuild&&n.breakInsertion&&(p=.25),s()<p}function In(a,e,t){let n=a;return e==="slow"?n+=.02:e==="fast"&&(n-=.015),t>=4&&(n+=.01),Math.max(.02,Math.min(.12,n))}function Kn(a,e){if(!a)return!1;const t=`${a}|${e}`;return t==="H|H"||t==="H|O"||t==="O|H"}function On(a,e,t){const n=(a==null?void 0:a.releaseRange)??[Sn,Rn],s=n[0]+t()*Math.max(0,n[1]-n[0]);return e.percussiveLayering?Math.max(n[0],s*.85):e.gradualBuild?Math.min(n[1],s*1.05):s}function An(a){const e=a.length>0?a:[0,4,7],t=[];for(let n=0;n<4;n++){const s=e[n%e.length],r=Math.floor(n/e.length)*12;t.push(s+r)}return t}function Fn(a,e,t){return a()<t?[...e].reverse():e}function kn(a,e,t,n,s){const r=Tn(n,s),i=Math.max(A.PAD_MIN,Math.round(a.velocity*A.ARPEGGIO_SCALE));if(t()<r.sustainProbability){const c=Q(a.midi,e,a.midi);return[{...a,startBeat:a.startBeat,durationBeats:Math.max(a.durationBeats,1),velocity:i,midi:c}]}const o=Fn(t,An(Re(e)),r.reverseProbability),l=t();let u;l<r.densityThresholds.sparse?u=2:l<r.densityThresholds.normal?u=4:u=1;const p=u===4?.25:u===2?.5:Math.max(a.durationBeats,1),d=[];for(let c=0;c<u;c++){const h=a.startBeat+p*c,g=o[c%o.length],v=B(a.midi+g,e),m=Q(v,e,a.midi);d.push({channelRole:"accompaniment",startBeat:h,durationBeats:p,degree:a.degree,velocity:i,sectionId:a.sectionId,midi:m})}return d}function Dn(a){const e=[];for(const t of a){const n=[0,.5];for(const s of n)e.push({...t,startBeat:t.startBeat+s,durationBeats:.5,velocity:Math.max(A.PAD_MIN,Math.round(t.velocity*A.BROKEN_SCALE))})}return e}function Cn(a){return a.map(e=>({...e,durationBeats:e.durationBeats>=1?e.durationBeats:1,velocity:Math.max(A.PAD_MIN,Math.round(e.velocity*A.STEADY_SCALE))}))}function wn(a,e,t){return{rng:Bn(a.seed??Mn),sectionById:new Map(e.sections.map(n=>[n.id,n])),totalBeats:(a.lengthInMeasures??32)*_,styleIntent:e.styleIntent,tempoSetting:a.tempo??"medium",phase1:e,phase2:t}}function Ln(a,e,t){const n=[],s=e.channel;for(let r=0;r<a.notes.length;r++){const i=a.notes[r],o=t.sectionById.get(i.sectionId);o&&Math.max(0,Math.floor(i.startBeat/_)-o.startMeasure);const l={midi:i.midi,velocity:Be(s,e.role,i.midi,i.velocity)},u=a.notes[r+1];if(u&&Hn(i,u,i.durationBeats,t.styleIntent,t.rng)){const p=Math.abs(u.midi-i.midi);l.slide={targetMidi:u.midi,durationSeconds:In(En,t.tempoSetting,p)}}Te(n,i.startBeat,i.durationBeats,s,l,t.totalBeats)}return n}function Nn(a,e,t){const n=[],s=e.channel;for(const r of a.notes)Te(n,r.startBeat,r.durationBeats,s,{midi:r.midi,velocity:Be(s,e.role,r.midi,r.velocity)},t.totalBeats);return n}function Gn(a,e,t){var n;const s=[],r=e.channel,i=new Map;for(const l of a.notes){const u=Math.floor(l.startBeat/_),p=i.get(u)??[];p.push(l),i.set(u,p)}const o=Array.from(i.keys()).sort((l,u)=>l-u);for(const l of o){const u=i.get(l),p=u.length?t.sectionById.get(u[0].sectionId):void 0,d=(p==null?void 0:p.texture)??"steady",c=I(t.phase1,((n=u[0])==null?void 0:n.startBeat)??l*_);let h;d==="arpeggio"?h=u.flatMap(f=>kn(f,c,t.rng,t.styleIntent,p==null?void 0:p.texture)):d==="broken"?h=Dn(u):h=Cn(u);const g=[],v=[];for(const f of h)t.rng()<t.phase1.techniqueStrategy.echoProbability&&g.push({...f,startBeat:f.startBeat+.25,velocity:Math.round(f.velocity*We.ECHO_SCALE)}),t.rng()<t.phase1.techniqueStrategy.detuneProbability&&v.push({...f,startBeat:f.startBeat,velocity:Math.round(f.velocity*We.DETUNE_SCALE),midi:f.midi,detuneCents:12});const m=[...h,...g,...v].map(f=>{const y=I(t.phase1,f.startBeat),b=t.phase2.tracks.find(R=>R.role==="melody"),x=b?jn(f.startBeat,b.notes):void 0,F=Q(f.midi,y,(x==null?void 0:x.midi)??f.midi);return{...f,midi:F}});for(const f of m)Te(s,f.startBeat,f.durationBeats,r,{midi:f.midi,velocity:Be(r,e.role,f.midi,f.velocity),detuneCents:f.detuneCents},t.totalBeats)}return s}function qn(a,e){const t=[];let n=null,s=null,r=null;const i=[...a].sort((o,l)=>o.startBeat-l.startBeat);for(const o of i){let l=o.startBeat;const u=xn[o.instrument];if(!u)continue;const p=Kn(r,o.instrument),d=p?0:Xe;s!==null&&l-s<=d&&(l=s+Math.max(d,Xe));const c=On(u,e.styleIntent,e.rng),h=Math.max(.01,Math.min(c*.7,c)),g=Math.min(o.durationBeats,bn);if(l>=e.totalBeats)continue;if(n!==null&&l<n)if(p&&t.length>=2){const m=t[t.length-1];m.command==="noteOff"&&(m.beatTime=l),n=l}else t.pop(),t.pop(),n=null,s=null;t.push({beatTime:l,channel:"noise",command:"noteOn",data:{noiseMode:u.spec,mode:u.spec,velocity:u.velocity,amplitude:u.amplitude,releaseSeconds:c,decaySeconds:h,periodIndex:u.periodIndex,clockDivider:u.periodIndex}});const v=Math.min(l+g,e.totalBeats);t.push({beatTime:v,channel:"noise",command:"noteOff",data:{}}),n=v,s=l,r=o.instrument}return t}function Un(a,e,t){const n=e.role;return n==="melody"||n==="melodyAlt"?Ln(a,e,t):n==="bass"||n==="bassAlt"?Nn(a,e,t):n==="accompaniment"||n==="pad"?Gn(a,e,t):[]}function Vn(a,e,t){const n=wn(a,e,t),s=[];for(const o of t.tracks){const l=e.voiceArrangement.voices.find(p=>p.role===o.role);if(!l)continue;const u=Un(o,l,n);s.push(...u)}const r=qn(t.drums,n);s.push(...r),s.sort((o,l)=>o.beatTime-l.beatTime);const i=Wn(s);return{events:s,diagnostics:i}}function Te(a,e,t,n,s,r){if(e>=r)return;a.push({beatTime:e,channel:n,command:"noteOn",data:s});const i=Math.min(e+t,r);a.push({beatTime:i,channel:n,command:"noteOff",data:s})}function Wn(a){const e=new Map,t={voiceAllocation:[]};for(const n of a){e.has(n.channel)||e.set(n.channel,0);const s=e.get(n.channel);n.command==="noteOn"?e.set(n.channel,s+1):n.command==="noteOff"&&s>0&&e.set(n.channel,s-1),t.voiceAllocation.push({beatTime:n.beatTime,channel:n.channel,activeCount:e.get(n.channel)})}return t}function jn(a,e){return e.find(t=>a>=t.startBeat&&a<t.startBeat+t.durationBeats)}const $n=[{channel:"square1",param:"duty",value:.25},{channel:"square2",param:"duty",value:.5}],zn=[{id:"DS_MEASURE_BOUNDARY_SWEEP",param:"duty",channels:["square1","square2"],minDurationBeats:1.5,requireMeasureBoundary:!0,steps:[.5,.75,.25]},{id:"DS_MINIMAL_LOW_PASS_THUMP",param:"duty",channels:["square1","square2"],minDurationBeats:2,requireMeasureBoundary:!0,steps:[.18,.38,.24]},{id:"DS_PROGRESSIVE_FILTER_RISE",param:"duty",channels:["square2"],minDurationBeats:4,steps:[.28,.46,.62,.76]},{id:"DS_PROGRESSIVE_PULSE_SQ1",param:"duty",channels:["square1"],minDurationBeats:3,steps:[.22,.4,.56]}],Yn=[{id:"GP_TRIANGLE_MEASURE_ACCENT",channel:"triangle",param:"gain",measureBoundaryValue:.9,defaultValue:.7},{id:"GP_NOISE_BREAK_SPILL",channel:"noise",param:"gain",measureBoundaryValue:.82,defaultValue:.7},{id:"GP_MINIMAL_BASS_SIDECHAIN",channel:"square2",param:"gain",measureBoundaryValue:.68,defaultValue:.56},{id:"GP_MINIMAL_PERC_FADE",channel:"noise",param:"gain",measureBoundaryValue:.7,defaultValue:.58},{id:"GP_PROGRESSIVE_PAD_SWELL",channel:"triangle",param:"gain",measureBoundaryValue:.88,defaultValue:.74},{id:"GP_PROGRESSIVE_SQUARE_GLIDE",channel:"square1",param:"gain",measureBoundaryValue:.8,defaultValue:.66}],Jn={initialParams:$n,dutySweeps:zn,gainProfiles:Yn},fe=Jn,Xn={square1:{base:.68,peak:.9},square2:{base:.66,peak:.88},triangle:{base:.48,peak:.68},noise:{base:.74,peak:.82}};function Qn(a,e){const t=[],n=a.events.reduce((u,p)=>Math.max(u,p.beatTime),0),s=Math.max(1,Math.ceil(n/_));for(const u of fe.initialParams??[])t.push({beatTime:0,channel:u.channel,command:"setParam",data:{param:u.param,value:u.value}});const r=[...fe.dutySweeps??[]],i=[...fe.gainProfiles??[]];e.filterMotion&&r.push({id:"STYLE_FILTER_SWELL",param:"duty",channels:["square1","square2"],minDurationBeats:2,steps:[.2,.6,.4,.75]}),e.percussiveLayering&&i.push({id:"STYLE_NOISE_PUNCH",channel:"noise",param:"gain",measureBoundaryValue:.85,defaultValue:.78}),e.percussiveLayering&&!e.breakInsertion&&i.push({id:"STYLE_MINIMAL_SIDECHAIN_SQ1",channel:"square1",param:"gain",measureBoundaryValue:.74,defaultValue:.62},{id:"STYLE_MINIMAL_SIDECHAIN_SQ2",channel:"square2",param:"gain",measureBoundaryValue:.72,defaultValue:.6}),e.atmosPad&&i.push({id:"STYLE_TRIANGLE_PAD",channel:"triangle",param:"gain",measureBoundaryValue:.82,defaultValue:.72}),e.gradualBuild&&e.breakInsertion&&r.push({id:"STYLE_PROGRESSIVE_DUTY_SWELL",param:"duty",channels:["square2"],minDurationBeats:1,steps:[.32,.58,.48,.68]}),e.gradualBuild&&e.breakInsertion&&i.push({id:"STYLE_PROGRESSIVE_TRI_RISE",channel:"triangle",param:"gain",measureBoundaryValue:.9,defaultValue:.76});const o=new Set;for(const u of a.events){if(u.command!=="noteOn")continue;const p=Zn(a.events,u),d=p?p.beatTime-u.beatTime:0;for(const c of r){if(!c.channels.includes(u.channel)||!p||d<c.minDurationBeats||c.requireMeasureBoundary&&!(ye(u.beatTime)||p&&ye(p.beatTime)))continue;const h=d/(c.steps.length+1);c.steps.forEach((g,v)=>{t.push({beatTime:u.beatTime+h*(v+1),channel:u.channel,command:"setParam",data:{param:c.param,value:g}})})}for(const c of i){if(u.channel!==c.channel)continue;const h=ye(u.beatTime)?c.measureBoundaryValue:c.defaultValue;t.push({beatTime:u.beatTime,channel:u.channel,command:"setParam",data:{param:c.param,value:h}})}if(e.breakInsertion&&u.channel==="noise"){const c=Math.floor(u.beatTime/_);if(!o.has(c)&&c>0&&(c+1)%8===0){o.add(c);const h=c*_;t.push({beatTime:h-.25>=0?h-.25:h,channel:"noise",command:"setParam",data:{param:"gain",value:.45}}),t.push({beatTime:h+1,channel:"noise",command:"setParam",data:{param:"gain",value:.78}});for(const g of["square1","square2"])t.push({beatTime:h-.25>=0?h-.25:h,channel:g,command:"setParam",data:{param:"gain",value:.55}}),t.push({beatTime:h+1,channel:g,command:"setParam",data:{param:"gain",value:.82}})}}}if(e.gradualBuild&&s>1){const u=Math.max(1,Math.floor(s/8));for(const[p,d]of Object.entries(Xn)){const c=p;for(let h=0;h<s;h+=u){const g=s>1?h/(s-1):1,v=Math.pow(g,e.loopCentric?.8:1),m=d.base+(d.peak-d.base)*v;t.push({beatTime:h*_,channel:c,command:"setParam",data:{param:"gain",value:Number(m.toFixed(3))}})}}}const l=[...a.events,...t];return l.sort((u,p)=>u.beatTime===p.beatTime?u.command===p.command?0:u.command==="setParam"?-1:p.command==="setParam"?1:0:u.beatTime-p.beatTime),{events:l}}function Zn(a,e){for(const t of a)if(t.channel===e.channel&&t.command==="noteOff"&&t.data===e.data&&t.beatTime>e.beatTime)return t}function ye(a){return Math.abs(a%_)<1e-6}function es(a,e,t,n,s){const r=60/a.bpm,i=e.map(l=>({time:l.beatTime*r,channel:l.channel,command:l.command,data:l.data}));i.sort((l,u)=>l.time-u.time);const o={voiceAllocation:t.voiceAllocation.map(l=>({time:l.beatTime*r,channel:l.channel,activeCount:l.activeCount})),loopWindow:ts(i),motifUsage:n,sectionMotifPlan:s};return{events:i,diagnostics:o}}function ts(a){if(!a.length)return{head:[],tail:[]};const e=.1,t=a[a.length-1].time,n=a.filter(s=>t-s.time<e);return{head:a.filter(s=>s.time<e),tail:n}}function as(a){return{percussiveMelodic:Math.max(-1,Math.min(1,a.percussiveMelodic)),calmEnergetic:Math.max(-1,Math.min(1,a.calmEnergetic))}}function ns(a){const{percussiveMelodic:e,calmEnergetic:t}=a,n=Math.max(0,-e),s=Math.max(0,e),r=Math.max(0,-t),i=Math.max(0,t);return{percussiveLayering:n>.3,syncopationBias:n>.4,breakInsertion:n>.35&&i>.4,harmonicStatic:s>.4&&r>.3||n>.3&&r>.2,atmosPad:s>.3||r>.5||i>.55,filterMotion:s>.3||i>.5,loopCentric:r>.3,textureFocus:r>.4||n>.5&&r>.2,gradualBuild:i>.4}}function ss(a){const{percussiveMelodic:e,calmEnergetic:t}=a;let n="mixed";e>.5&&t>.3?n="ascending":e>.4&&(n="stepwise");const s=-e+t*.5;let r="medium";s>.6?r="high":s<-.4&&(r="low");let i="balanced";return t>.5?i="aggressive":t<-.5&&(i="soft"),{melodyContour:n,drumDensity:r,velocityCurve:i}}function rs(a){return a.calmEnergetic*20}function is(a){return a.calmEnergetic<-.4?"slow":a.calmEnergetic>.4?"fast":"medium"}function os(a){const{percussiveMelodic:e,calmEnergetic:t}=a;let n="medium";t>.4&&(n="high"),t<-.4&&(n="low");let s="upbeat";return t<=-.5?s="peaceful":e<=-.4?s="tense":e>=.4?s="sad":t>=.4&&(s="upbeat"),{energy:n,mood:s}}const ls={"minimal-techno":{percussiveMelodic:-.4,calmEnergetic:-.3},"progressive-house":{percussiveMelodic:-.45,calmEnergetic:.6},"retro-loopwave":{percussiveMelodic:.3,calmEnergetic:-.2},"breakbeat-jungle":{percussiveMelodic:-.7,calmEnergetic:.7},"lofi-chillhop":{percussiveMelodic:.5,calmEnergetic:-.6}},He=["textureFocus","loopCentric","gradualBuild","harmonicStatic","percussiveLayering","breakInsertion","filterMotion","syncopationBias","atmosPad"],us={textureFocus:!1,loopCentric:!1,gradualBuild:!1,harmonicStatic:!1,percussiveLayering:!1,breakInsertion:!1,filterMotion:!1,syncopationBias:!1,atmosPad:!1},ds={"minimal-techno":"minimalTechno","progressive-house":"progressiveHouse","retro-loopwave":"retroLoopwave","breakbeat-jungle":"breakbeatJungle","lofi-chillhop":"lofiChillhop"},cs=.35,ps={percussiveMelodic:0,calmEnergetic:0};function hs(a){let e=a>>>0;return e===0&&(e=1),()=>(e=e*1664525+1013904223>>>0,e/4294967295)}function gs(a,e,t){const n={...us};for(const s of He){const r=a[s];typeof r=="boolean"?n[s]=r:t&&e?n[s]=e()>=.5:n[s]=!1}return n}function ms(a,e){return{melodyContour:e.melodyContour??(a==null?void 0:a.melodyContour),drumDensity:e.drumDensity??(a==null?void 0:a.drumDensity),velocityCurve:e.velocityCurve??(a==null?void 0:a.velocityCurve)}}function vs(a,e){var t,n,s,r;const i={tempo:e.tempo??a.tempo,bpmBias:e.bpmBias??a.bpmBias,motifTags:{include:((t=e.motifTags)==null?void 0:t.include)??a.motifTags.include??[],exclude:((n=e.motifTags)==null?void 0:n.exclude)??a.motifTags.exclude??[]},intent:{...a.intent},expression:ms(a.expression,e.expression??{}),randomizeUnsetIntent:e.randomizeUnsetIntent??a.randomizeUnsetIntent};if((s=e.motifTags)!=null&&s.include&&(i.motifTags.include=e.motifTags.include.slice()),(r=e.motifTags)!=null&&r.exclude&&(i.motifTags.exclude=e.motifTags.exclude.slice()),e.intent)for(const o of He){const l=e.intent[o];typeof l=="boolean"&&(i.intent[o]=l)}return i}function fs(a){let e,t=Number.POSITIVE_INFINITY;for(const[n,s]of Object.entries(ls)){const r=Math.hypot(a.percussiveMelodic-s.percussiveMelodic,a.calmEnergetic-s.calmEnergetic);r<t&&(t=r,e=n)}if(!(!e||t>cs))return ds[e]??void 0}function ys(a){var e;const t=a.lengthInMeasures>0?Math.trunc(a.lengthInMeasures):32,n=typeof a.seed=="number"&&Number.isFinite(a.seed)?Math.trunc(a.seed):Math.floor(Math.random()*4294967295),s=a.twoAxisStyle??ps,r=as(s);let i=ns(r);if((e=a.overrides)!=null&&e.intent)for(const b of He){const x=a.overrides.intent[b];typeof x=="boolean"&&(i[b]=x)}const o=ss(r),l=rs(r),u=is(r),p=os(r),d=p.mood;let c={tempo:u,bpmBias:l,motifTags:{include:[],exclude:[]},intent:i,expression:o,randomizeUnsetIntent:!1};a.overrides&&(c=vs(c,a.overrides));const h=c.randomizeUnsetIntent??!1,g=h?hs(n):null,v=gs(c.intent,g,h);c={...c,intent:v,randomizeUnsetIntent:h};const m={mood:d,tempo:c.tempo??"medium",lengthInMeasures:t,seed:n,stylePreset:fs(r),styleOverrides:v},f={...c,tags:{mood:p.mood,energy:p.energy},twoAxisStyle:{...r}},y={lengthInMeasures:t,seed:n,twoAxisStyle:{...r}};return a.overrides&&(y.overrides=JSON.parse(JSON.stringify(a.overrides))),{legacy:m,profile:f,replayOptions:y}}function _s(a){const{legacy:e,profile:t,replayOptions:n}=bs(a),s=Zt(e),r=gn(e,s),i=Vn(e,s,r),o=Qn(i,s.styleIntent),l=es(s,o.events,i.diagnostics,r.motifUsage,r.sectionMotifPlan),u=e.lengthInMeasures*4,p=u/s.bpm*60;return{events:l.events,diagnostics:l.diagnostics,meta:{bpm:s.bpm,key:s.key,seed:e.seed,mood:e.mood,tempo:e.tempo,lengthInMeasures:e.lengthInMeasures,styleIntent:s.styleIntent,voiceArrangement:s.voiceArrangement,profile:t,replayOptions:n,loopInfo:{loopStartBeat:0,loopEndBeat:u,loopStartTime:0,loopEndTime:p,totalBeats:u,totalDuration:p}}}}async function Ms(a){return _s(a)}function bs(a){return ys(a)}const Ss=[{id:"SE_JUMP_01",type:"jump",description:"",channels:["square1"],durationRange:[.12,.25],channelParams:{square1:{pitchStart:{min:50,max:62},pitchEnd:{min:72,max:84},dutyCycle:[.25,.5],velocityRange:[96,122]}},pitchSweep:{enabled:!0,curveOptions:["linear","exponential"],durationRange:[.14,.26]}},{id:"SE_JUMP_02",type:"jump",description:"",channels:["square2"],durationRange:[.15,.3],channelParams:{square2:{pitchStart:{min:40,max:52},pitchEnd:{min:64,max:76},dutyCycle:[.5],velocityRange:[94,120]}},pitchSweep:{enabled:!0,curveOptions:["linear","exponential"],durationRange:[.16,.32]}},{id:"SE_COIN_01",type:"coin",description:"2",channels:["square1"],durationRange:[.18,.24],channelParams:{square1:{pitchStart:{min:72,max:84},dutyCycle:[.5],velocityRange:[102,124]}},noteSequence:{intervals:[0,4],noteDurations:[.04,.16]}},{id:"SE_COIN_02",type:"coin",description:"3",channels:["square1"],durationRange:[.2,.28],channelParams:{square1:{pitchStart:{min:76,max:84},dutyCycle:[.5]}},noteSequence:{intervals:[0,4,12],noteDurations:[.04,.04,.16]}},{id:"SE_EXPLOSION_01",type:"explosion",description:" + ",channels:["noise","triangle"],durationRange:[.8,1.2],channelParams:{noise:{noiseMode:"long",envelope:"percussive",velocityRange:[92,120],releaseRange:[.5,.8]},triangle:{pitchStart:{min:36,max:43},pitchEnd:{min:24,max:31}}},pitchSweep:{enabled:!0,curveType:"linear"}},{id:"SE_EXPLOSION_02",type:"explosion",description:"",channels:["noise"],durationRange:[.4,.6],channelParams:{noise:{noiseMode:"short",envelope:"percussive",velocityRange:[90,118],releaseRange:[.22,.4]}}},{id:"SE_HIT_01",type:"hit",description:"",channels:["square1"],durationRange:[.08,.12],channelParams:{square1:{pitchStart:{min:60,max:72},dutyCycle:[.125],envelope:"percussive",velocityRange:[100,126]}},noteSequence:{intervals:[0,-2,-5],noteDurations:[.03,.03,.03]}},{id:"SE_HIT_02",type:"hit",description:" + ",channels:["square1","noise"],durationRange:[.1,.15],channelParams:{square1:{pitchStart:{min:48,max:60},dutyCycle:[.125],velocityRange:[96,120]},noise:{noiseMode:"short",envelope:"percussive",velocityRange:[94,120],releaseRange:[.12,.2]}}},{id:"SE_POWERUP_01",type:"powerup",description:"",channels:["square1"],durationRange:[.33,.46],channelParams:{square1:{pitchStart:{min:60,max:67},dutyCycle:[.5]}},noteSequence:{intervals:[0,4,7,12],noteDurations:[.08,.08,.08,.13]}},{id:"SE_POWERUP_02",type:"powerup",description:"5",channels:["square2"],durationRange:[.4,.52],channelParams:{square2:{pitchStart:{min:64,max:72},dutyCycle:[.25]}},noteSequence:{intervals:[0,4,7,12,16],noteDurations:[.07,.07,.07,.07,.16]}},{id:"SE_SELECT_01",type:"select",description:"",channels:["square1"],durationRange:[.05,.08],channelParams:{square1:{pitchStart:{min:72,max:84},dutyCycle:[.25]}}},{id:"SE_SELECT_02",type:"select",description:"2",channels:["square1"],durationRange:[.06,.1],channelParams:{square1:{pitchStart:{min:72,max:84},dutyCycle:[.5]}},noteSequence:{intervals:[0,4],noteDurations:[.03,.04]}},{id:"SE_LASER_01",type:"laser",description:"",channels:["square1"],durationRange:[.1,.15],channelParams:{square1:{pitchStart:{min:72,max:84},pitchEnd:{min:48,max:60},dutyCycle:[.125,.25]}},pitchSweep:{enabled:!0,curveType:"exponential"}},{id:"SE_LASER_02",type:"laser",description:"",channels:["square2"],durationRange:[.12,.2],channelParams:{square2:{pitchStart:{min:76,max:88},pitchEnd:{min:52,max:64},dutyCycle:[.125]}},pitchSweep:{enabled:!0,curveType:"linear"}},{id:"SE_CLICK_01",type:"click",description:"",channels:["square1"],durationRange:[.02,.03],channelParams:{square1:{pitchStart:{min:84,max:96},dutyCycle:[.125],envelope:"percussive"}}},{id:"SE_CLICK_02",type:"click",description:"",channels:["square1"],durationRange:[.03,.04],channelParams:{square1:{pitchStart:{min:88,max:100},dutyCycle:[.125],envelope:"percussive"}}},{id:"SE_SYNTH_01",type:"synth",description:"",channels:["square1"],durationRange:[.15,.3],channelParams:{square1:{pitchStart:{min:48,max:72},dutyCycle:[.125,.25,.5]}}},{id:"SE_SYNTH_02",type:"synth",description:"",channels:["triangle"],durationRange:[.2,.4],channelParams:{triangle:{pitchStart:{min:60,max:84}}}},{id:"SE_TONE_01",type:"tone",description:"",channels:["square1"],durationRange:[.1,.2],channelParams:{square1:{pitchStart:{min:60,max:72},dutyCycle:[.5]}}},{id:"SE_TONE_02",type:"tone",description:"",channels:["triangle"],durationRange:[.12,.3],channelParams:{triangle:{pitchStart:{min:60,max:72}}}}],Rs={templates:Ss};function xs(){return Rs.templates}function Ps(a){let e=a>>>0;return e===0&&(e=1),()=>(e=e*1664525+1013904223>>>0,e/4294967295)}class Es{constructor(){this.templates=xs()}generateSE(e){const t=e.seed??Math.floor(Math.random()*1e9),n=Ps(t),s=this.selectTemplate(e,n),r=this.concretizeParameters(s,n,e.baseFrequency),i=this.generateEvents(s,r,e.startTime??0),o={type:e.type,seed:t,startTime:e.startTime??0};return e.templateId&&(o.templateId=e.templateId),e.baseFrequency!==void 0&&(o.baseFrequency=e.baseFrequency),{events:i,meta:{type:e.type,templateId:s.id,seed:t,duration:r.duration,channels:s.channels,replayOptions:o}}}selectTemplate(e,t){if(e.templateId){const s=this.templates.find(r=>r.id===e.templateId);if(!s)throw new Error(`Template not found: ${e.templateId}`);return s}const n=this.templates.filter(s=>s.type===e.type);if(n.length===0)throw new Error(`No templates found for type: ${e.type}`);return n[Math.floor(t()*n.length)]}concretizeParameters(e,t,n){var s;const[r,i]=e.durationRange,o=r+t()*(i-r),l={};let u=0;n!==void 0&&(u=this.calculatePitchShift(e,n));for(const p of e.channels){const d=e.channelParams[p];if(!d)continue;const c=d.velocityRange?d.velocityRange:p==="noise"?[88,118]:[96,122],h=Math.round(Math.max(1,Math.min(127,this.sampleFloatRange(c,t)))),g=d.pitchStart?this.samplePitchRange(d.pitchStart,t):void 0,v=d.pitchEnd?this.samplePitchRange(d.pitchEnd,t):void 0;if(l[p]={pitchStart:g!==void 0?this.clampMidi(g+u):void 0,pitchEnd:v!==void 0?this.clampMidi(v+u):void 0,dutyCycle:d.dutyCycleRange?this.sampleFloatRange([d.dutyCycleRange.min,d.dutyCycleRange.max],t):d.dutyCycle?d.dutyCycle[Math.floor(t()*d.dutyCycle.length)]:void 0,noiseMode:d.noiseMode,envelope:d.envelope,velocity:h,releaseSeconds:d.releaseRange?this.sampleFloatRange(d.releaseRange,t):void 0},(s=e.pitchSweep)!=null&&s.enabled){const m=e.pitchSweep.curveOptions??(e.pitchSweep.curveType?[e.pitchSweep.curveType]:void 0);m&&(l[p].sweepCurve=this.weightedChoice(m,e.pitchSweep.curveWeights,t)??e.pitchSweep.curveType),e.pitchSweep.durationRange&&(l[p].sweepDuration=this.sampleFloatRange(e.pitchSweep.durationRange,t))}}return{duration:o,channelParams:l}}samplePitchRange(e,t){return Math.floor(e.min+t()*(e.max-e.min+1))}sampleFloatRange(e,t){return e[0]+t()*(e[1]-e[0])}weightedChoice(e,t,n){if(!t)return e[Math.floor(n()*e.length)];const s=e.reduce((i,o)=>i+(t[String(o)]||1),0);let r=n()*s;for(const i of e){const o=t[String(i)]||1;if(r<o)return i;r-=o}return e[e.length-1]}generateEvents(e,t,n){const s=[];for(const r of e.channels){const i=t.channelParams[r],o=this.generateChannelEvents(r,e,i,t,n);s.push(...o)}return s.sort((r,i)=>r.time-i.time),s}generateChannelEvents(e,t,n,s,r){return e.startsWith("square")?this.generateSquareEvents(e,t,n,s,r):e==="triangle"?this.generateTriangleEvents(e,t,n,s,r):e==="noise"?this.generateNoiseEvents(t,n,s,r):[]}generateSquareEvents(e,t,n,s,r){var i;const o=[];return n.dutyCycle!==void 0&&o.push({time:r,channel:e,command:"setParam",data:{param:"duty",value:n.dutyCycle}}),t.noteSequence?o.push(...this.generateNoteSequence(e,t,n,r)):(i=t.pitchSweep)!=null&&i.enabled?o.push(...this.generatePitchSweep(e,t,n,s,r)):n.pitchStart!==void 0&&o.push(...this.generateSimpleNote(e,n,s.duration,r)),o}generateTriangleEvents(e,t,n,s,r){var i;const o=[];return t.noteSequence?o.push(...this.generateNoteSequence(e,t,n,r)):(i=t.pitchSweep)!=null&&i.enabled?o.push(...this.generatePitchSweep(e,t,n,s,r)):n.pitchStart!==void 0&&o.push(...this.generateSimpleNote(e,n,s.duration,r)),o}generateNoiseEvents(e,t,n,s){const r=[],i="noise";t.noiseMode&&r.push({time:s,channel:i,command:"setParam",data:{param:"noiseMode",value:t.noiseMode}});const o=t.velocity??110,l=t.releaseSeconds??n.duration*.3,u={velocity:o};return t.noiseMode&&(u.noiseMode=t.noiseMode),t.envelope==="percussive"?(u.decaySeconds=n.duration*.7,u.releaseSeconds=l):t.releaseSeconds&&(u.releaseSeconds=l),r.push({time:s,channel:i,command:"noteOn",data:u}),r.push({time:s+n.duration,channel:i,command:"noteOff",data:{}}),r}generateNoteSequence(e,t,n,s){const r=[];if(!t.noteSequence)return r;let i=s;const o=n.pitchStart,l=n.velocity??110;for(let u=0;u<t.noteSequence.intervals.length;u++){const p=o+t.noteSequence.intervals[u],d=t.noteSequence.noteDurations[u];r.push({time:i,channel:e,command:"noteOn",data:{midi:p,velocity:l}}),r.push({time:i+d,channel:e,command:"noteOff",data:{}}),i+=d}return r}generatePitchSweep(e,t,n,s,r){var i;const o=[];if(!((i=t.pitchSweep)!=null&&i.enabled))return o;const l=n.sweepDuration??s.duration,u=n.sweepCurve??t.pitchSweep.curveType??"exponential",p=n.velocity??110;return o.push({time:r,channel:e,command:"noteOn",data:{midi:n.pitchStart,velocity:p}}),o.push({time:r,channel:e,command:"setParam",data:{param:"pitchBend",value:n.pitchEnd,rampDuration:l,curve:u}}),o.push({time:r+l,channel:e,command:"noteOff",data:{}}),o}generateSimpleNote(e,t,n,s){const r=[],i=t.velocity??110,o=t.releaseSeconds;return r.push({time:s,channel:e,command:"noteOn",data:{midi:t.pitchStart,velocity:i}}),r.push({time:s+n,channel:e,command:"noteOff",data:o?{releaseSeconds:o}:{}}),r}calculatePitchShift(e,t){for(const n of e.channels){const s=e.channelParams[n];if(!(s!=null&&s.pitchStart))continue;const r=(s.pitchStart.min+s.pitchStart.max)/2,i=ia(r),o=t/i,l=ra(o);return Math.round(l)}return 0}clampMidi(e){return Math.max(0,Math.min(127,Math.round(e)))}}const Qe=.1,Bs=25,Ze=.3,Ts=1789773,_e=[4,8,16,32,64,96,128,160,202,254,380,508,762,1016,2034,4068],et={K:{mode:"long",periodIndex:14,baseAmplitude:.75,decaySeconds:.22,releaseSeconds:.04,cutoffHz:3200},S:{mode:"short",periodIndex:4,baseAmplitude:.65,decaySeconds:.14,releaseSeconds:.03,cutoffHz:5200},H:{mode:"short",periodIndex:1,baseAmplitude:.45,decaySeconds:.06,releaseSeconds:.02,cutoffHz:7800},O:{mode:"short",periodIndex:2,baseAmplitude:.6,decaySeconds:.4,releaseSeconds:.06,cutoffHz:6800},T:{mode:"long",periodIndex:10,baseAmplitude:.6,decaySeconds:.26,releaseSeconds:.05,cutoffHz:3600},default:{mode:"short",periodIndex:3,baseAmplitude:.6,decaySeconds:.14,releaseSeconds:.03,cutoffHz:6e3}},Hs=69,Is=440;function le(a){return Is*Math.pow(2,(a-Hs)/12)}function Ks(a,e=.85){return Math.max(0,Math.min(1,(a??100)/127*e))}class Ie{constructor(e,t,n){this.context=e;const s=new AudioWorkletNode(e,t);s.connect(n),this.port=s.port,this.sampleRate=e.sampleRate}scheduleMessage(e,t){const n=Math.max(0,Math.round(t*this.sampleRate));this.port.postMessage({...e,sampleFrame:n})}stop(){this.port.postMessage({type:"clear"})}}class tt extends Ie{constructor(e,t){super(e,"square-processor",t),this.currentDuty=.5}noteOn(e,t){const n=e.detuneCents??0,s=Math.pow(2,n/1200),r={type:"noteOn",frequency:e.frequency*s,amplitude:e.amplitude??.8,duty:e.duty??this.currentDuty};e.slide&&(r.slide={targetFrequency:e.slide.targetFrequency,durationSamples:Math.round((e.slide.durationSeconds??0)*this.sampleRate)}),this.scheduleMessage(r,t)}noteOff(e,t){this.scheduleMessage({type:"noteOff"},t)}setParam(e,t){if(e.param==="duty"&&(this.currentDuty=Number(e.value??this.currentDuty)),e.param==="pitchBend"&&typeof e.value=="number"){const n=e.value>0?le(e.value):0,s=Number(e.rampDuration??0),r=e.curve??"linear";this.scheduleMessage({type:"setParam",param:"pitchBend",value:n,rampDuration:s,curve:r},t);return}this.scheduleMessage({type:"setParam",param:e.param,value:e.value},t)}}class Os extends Ie{constructor(e,t){super(e,"triangle-processor",t)}noteOn(e,t){const n={type:"noteOn",frequency:e.frequency,amplitude:e.amplitude??.7};this.scheduleMessage(n,t)}noteOff(e,t){this.scheduleMessage({type:"noteOff"},t)}setParam(e,t){if(e.param==="pitchBend"&&typeof e.value=="number"){const n=e.value>0?le(e.value):0,s=Number(e.rampDuration??0),r=e.curve??"linear";this.scheduleMessage({type:"setParam",param:"pitchBend",value:n,rampDuration:s,curve:r},t);return}this.scheduleMessage({type:"setParam",param:e.param,value:e.value},t)}}class As extends Ie{constructor(e,t){super(e,"noise-processor",t),this.periodIndex=0,this.mode="short"}noteOn(e,t){const n=Math.max(0,Math.min(_e.length-1,e.periodIndex??this.periodIndex)),s=_e[n]*16/Ts,r=Math.max(1,Math.round(s*this.sampleRate)),i=Math.max(.001,e.decaySeconds??.12),o=Math.max(.001,e.releaseSeconds??.03),l=Math.max(1,Math.round(i*this.sampleRate)),u=Math.max(1,Math.round(o*this.sampleRate)),p=Math.max(0,Math.min(1,e.amplitude??.6)),d=e.mode==="long"?"long":"short",c=Math.max(100,Math.min(this.sampleRate/2,e.cutoffHz??6e3));this.periodIndex=n,this.mode=d,this.scheduleMessage({type:"noteOn",mode:d,amplitude:p,periodSamples:r,decaySamples:l,releaseSamples:u,cutoffHz:c},t)}noteOff(e,t){const n=Math.max(.001,Number((e==null?void 0:e.releaseSeconds)??.03)),s=Math.max(1,Math.round(n*this.sampleRate));this.scheduleMessage({type:"noteOff",releaseSamples:s},t)}setParam(e,t){if(!(!e||!e.param)){if(e.param==="mode"&&typeof e.value=="string"&&(this.mode=e.value==="long"?"long":"short"),e.param==="periodIndex"){const n=Number(e.value??this.periodIndex);this.periodIndex=Math.max(0,Math.min(_e.length-1,n))}this.scheduleMessage({type:"setParam",param:e.param,value:e.value},t)}}}const _t=class Se{constructor(e,t={}){this.context=e,this.events=[],this.eventIndex=0,this.lookahead=Qe,this.leadTime=Ze,this.intervalHandle=null,this.startTime=0,this.lastEventTime=0,this.completionResolver=null,this.loopEnabled=!1,this.eventCallback=null,this.masterGainNode=e.createGain(),this.masterGainNode.gain.value=Se.BASE_GAIN,this.masterGainNode.connect(e.destination),this.workletBasePath=t.workletBasePath??"./worklets/"}async init(){const e=this.context,t=this.workletBasePath;await e.audioWorklet.addModule(`${t}square-processor.js`),await e.audioWorklet.addModule(`${t}triangle-processor.js`),await e.audioWorklet.addModule(`${t}noise-processor.js`),this.channels={square1:new tt(e,this.masterGainNode),square2:new tt(e,this.masterGainNode),triangle:new Os(e,this.masterGainNode),noise:new As(e,this.masterGainNode)}}get masterGain(){return this.masterGainNode}stop(){this.intervalHandle!==null&&(clearInterval(this.intervalHandle),this.intervalHandle=null),Object.values(this.channels).forEach(e=>e.stop()),this.completionResolver&&(this.completionResolver(),this.completionResolver=null)}play(e,t={}){this.stop(),this.events=e??[],this.lookahead=t.lookahead??Qe,this.leadTime=t.leadTime??Ze,this.loopEnabled=t.loop??!1,this.eventCallback=t.onEvent??null;const n=t.volume??1;this.masterGainNode.gain.value=Se.BASE_GAIN*n;const s=this.events.length?this.events[this.events.length-1].time:0;let r=Math.max(0,t.offset??0);r>0&&(this.loopEnabled&&s>0?r=r%s:r=Math.min(r,s));const i=this.context.currentTime,o=t.startTime??i+this.leadTime;this.startTime=o-r,this.lastEventTime=s,this.eventIndex=this.resolveEventIndex(r);const l=new Promise(p=>{this.completionResolver=p}),u=()=>this.tick();return this.intervalHandle=window.setInterval(u,Bs),u(),l}resolveEventIndex(e){if(e<=0)return 0;const t=.001;for(let n=0;n<this.events.length;n+=1)if(this.events[n].time+t>=e)return n;return this.events.length}tick(){const e=this.context.currentTime,t=e+this.lookahead;for(;this.eventIndex<this.events.length;){const n=this.events[this.eventIndex],s=this.startTime+n.time;if(s<=t)this.dispatchEvent(n,s),this.eventIndex+=1;else break}if(this.loopEnabled&&this.eventIndex>=this.events.length&&(this.startTime+=this.lastEventTime,this.eventIndex=0),!this.loopEnabled){const n=this.startTime+this.lastEventTime+1;this.eventIndex>=this.events.length&&e>=n&&this.stop()}}dispatchEvent(e,t){const n=e.data??{};switch(this.eventCallback&&this.eventCallback(e,t),e.channel){case"square1":case"square2":e.command==="noteOn"?this.channels[e.channel].noteOn(this.mapPitchData(n),t):e.command==="noteOff"?this.channels[e.channel].noteOff(n,t):e.command==="setParam"&&this.channels[e.channel].setParam(n,t);break;case"triangle":e.command==="noteOn"?this.channels.triangle.noteOn(this.mapPitchData(n),t):e.command==="noteOff"?this.channels.triangle.noteOff(n,t):e.command==="setParam"&&this.channels.triangle.setParam(n,t);break;case"noise":e.command==="noteOn"?this.channels.noise.noteOn(this.mapNoiseData(n),t):e.command==="noteOff"?this.channels.noise.noteOff(n,t):e.command==="setParam"&&this.channels.noise.setParam(n,t);break}}mapPitchData(e){const t=Number(e.midi??60),n=Number(e.detuneCents??0);let s=null;const r=e.slide;return r&&(typeof r.targetMidi=="number"?s={targetFrequency:le(r.targetMidi),durationSeconds:Number(r.durationSeconds??0)}:typeof r.targetFrequency=="number"&&(s={targetFrequency:r.targetFrequency,durationSeconds:Number(r.durationSeconds??0)})),{frequency:le(t),amplitude:Ks(typeof e.velocity=="number"?e.velocity:void 0),duty:typeof e.duty=="number"?e.duty:void 0,detuneCents:n,slide:s}}mapNoiseData(e){const t=typeof e.velocity=="number"?e.velocity:100,n=Math.max(0,Math.min(1,t/127)),s=typeof e.instrument=="string"?e.instrument:"S",r=et[s]??et.default,i=Math.min(1,Math.max(0,(typeof e.amplitude=="number"?e.amplitude:r.baseAmplitude)*n)),o=typeof e.decaySeconds=="number"?e.decaySeconds:r.decaySeconds,l=typeof e.releaseSeconds=="number"?e.releaseSeconds:r.releaseSeconds,u=typeof e.periodIndex=="number"?e.periodIndex:typeof e.clockDivider=="number"?e.clockDivider:typeof e.period=="number"?e.period:r.periodIndex,p=typeof e.mode=="string"?e.mode:typeof e.noiseMode=="string"?e.noiseMode:r.mode,d=typeof e.cutoffHz=="number"?e.cutoffHz:r.cutoffHz;return{amplitude:i,decaySeconds:o,releaseSeconds:l,periodIndex:u,mode:p,cutoffHz:d}}};_t.BASE_GAIN=.16;let at=_t,Me=null;function Fs(){return Me||(Me=new Es),Me}async function ks(a){return await Ms(a)}async function Ds(a){return Fs().generateSE(a)}const nt=-6,Cs=1,ws=.03,ae=.001;class Ls{constructor(e,t,n,s){this.context=e,this.seSynth=t,this.getTimeline=n,this.bgmGain=s,this.scheduledByType={},this.nextTriggerTime=null,this.flushHandle=null,this.nominalGain=s.gain.value}async play(e,t={}){const n={duckingDb:t.duckingDb??nt,volume:t.volume??Cs,quantize:t.quantize},s=e.meta.type;return this.scheduledByType[s]?Promise.resolve():new Promise((r,i)=>{const o=this.determineTargetTime(n),l={result:e,options:n,targetTime:o,resolve:r,reject:i};this.scheduledByType[s]=l,this.registerJob(l)})}resetDucking(){const e=this.context.currentTime,t=this.bgmGain.gain;t.cancelScheduledValues(e),t.setValueAtTime(this.nominalGain,e)}cancelPendingJobs(){this.flushHandle!==null&&(clearTimeout(this.flushHandle),this.flushHandle=null);const e=Object.values(this.scheduledByType).filter(t=>t!=null);for(const t of e)t.resolve();this.scheduledByType={},this.nextTriggerTime=null}registerJob(e){if(this.nextTriggerTime===null||e.targetTime<this.nextTriggerTime-ae){this.nextTriggerTime=e.targetTime,this.alignJobsTo(this.nextTriggerTime),this.scheduleFlush();return}if(Math.abs(e.targetTime-this.nextTriggerTime)<=ae){e.targetTime=this.nextTriggerTime;return}e.targetTime=this.nextTriggerTime}alignJobsTo(e){for(const t of Object.values(this.scheduledByType))t&&(t.targetTime=e)}determineTargetTime(e){const t=this.context,n=t.currentTime;let s=n;if(e.quantize){const r=this.quantizeStart(e.quantize,n);r!==null&&(s=r)}return s<t.currentTime+ae&&(s=t.currentTime+ae),s}scheduleFlush(){if(this.nextTriggerTime===null)return;this.flushHandle!==null&&clearTimeout(this.flushHandle);const e=this.context.currentTime,t=this.nextTriggerTime-ws,n=Math.max(0,(t-e)*1e3);this.flushHandle=window.setTimeout(()=>{this.flushHandle=null,this.flushScheduled()},n)}flushScheduled(){const e=this.nextTriggerTime;if(e===null)return;const t=Object.values(this.scheduledByType).filter(o=>o!=null);if(t.length===0){this.nextTriggerTime=null;return}const n=this.context,s=Math.max(e,n.currentTime+.005),r=t.reduce((o,l)=>Math.max(o,l.result.meta.duration),0),i=t.reduce((o,l)=>Math.min(o,l.options.duckingDb),nt);this.applyDucking(i,r,s),this.nextTriggerTime=null,this.scheduledByType={};for(const o of t)try{this.seSynth.play(o.result.events,{startTime:s,loop:!1,volume:o.options.volume}).then(o.resolve,o.reject)}catch(l){o.reject(l)}}quantizeStart(e,t){const n=this.getTimeline();if(!n)return null;const{meta:s,startTime:r}=n,i=60/s.bpm,o=4,l=s.loopInfo.totalBeats,u=this.resolveStepBeats(e.quantizeTo,o);if(u<=0)return null;const p=Math.max(0,(t-r)/i);let d=this.resolvePhaseBeat(e.phase??"next",p,u,o);if(d+=e.offsetBeats??0,e.loopAware&&l>0){for(;d*i+r<t-.001;)d+=u;const c=l;if(d>=c){d=d%c;const h=Math.ceil((p-d)/c);d+=h*c}}else{const c=u*i;let h=r+d*i;for(;h<t-.001;)h+=c,d+=u;return h}return r+d*i}resolveStepBeats(e,t){return e==="beat"?1:e==="half"?.5:e==="measure"?t:typeof e=="object"&&e.subdivision>0?1/e.subdivision:0}resolvePhaseBeat(e,t,n,s){if(e==="current"){const o=Math.floor(t/n)*n;return o+1e-6<t?o+n:o}if(e==="next"||e==null)return Math.ceil((t-1e-6)/n)*n;const r=Math.max(0,e.measure),i=Math.max(0,e.beat??0);return r*s+i}applyDucking(e,t,n){if(!Number.isFinite(e)||e>=0)return;const s=this.bgmGain,r=this.context.currentTime,i=Math.pow(10,e/20),o=Math.max(0,this.nominalGain*i),l=Math.max(r,n-.005),u=l+.02,d=Math.max(u,n+t)+Math.max(.05,t*.5),c=s.gain;c.cancelScheduledValues(r),c.setValueAtTime(this.nominalGain,r),c.setValueAtTime(this.nominalGain,l),c.linearRampToValueAtTime(o,u),c.linearRampToValueAtTime(this.nominalGain,d)}}const W=document.getElementById("two-axis-panel"),U=document.getElementById("two-axis-canvas"),E=document.getElementById("play-pause-button"),ne=document.getElementById("button-text"),Ns=document.getElementById("status-message"),Gs=document.getElementById("sr-status"),he={square1:document.querySelector('[data-channel="square1"] .indicator-light'),square2:document.querySelector('[data-channel="square2"] .indicator-light'),triangle:document.querySelector('[data-channel="triangle"] .indicator-light'),noise:document.querySelector('[data-channel="noise"] .indicator-light')},Mt={square1:"jump",square2:"select",triangle:"laser",noise:"explosion"},M={currentPosition:null,composition:null,isPlaying:!1,isGenerating:!1,channelActivity:{square1:0,square2:0,triangle:0,noise:0}};let P=null,K=null,N=null,H=null,V=null,ie=null,j=new Map,be=!1,X=0;function bt(){const a=W.getBoundingClientRect(),e=window.devicePixelRatio||1;U.width=a.width*e,U.height=a.height*e,U.style.width=`${a.width}px`,U.style.height=`${a.height}px`;const t=U.getContext("2d");t&&(t.scale(e,e),St(t,a.width,a.height))}function St(a,e,t){a.clearRect(0,0,e,t),a.strokeStyle="rgba(255, 255, 255, 0.08)",a.lineWidth=1;for(let r=1;r<4;r++){const i=e/4*r;a.beginPath(),a.moveTo(i,0),a.lineTo(i,t),a.stroke()}for(let r=1;r<4;r++){const i=t/4*r;a.beginPath(),a.moveTo(0,i),a.lineTo(e,i),a.stroke()}a.strokeStyle="rgba(255, 255, 255, 0.15)",a.lineWidth=2;const n=e/2,s=t/2;if(a.beginPath(),a.moveTo(n,0),a.lineTo(n,t),a.stroke(),a.beginPath(),a.moveTo(0,s),a.lineTo(e,s),a.stroke(),M.currentPosition){const r=(M.currentPosition.percussiveMelodic+1)/2*e,i=(1-M.currentPosition.calmEnergetic)/2*t,o=a.createRadialGradient(r,i,0,r,i,30);o.addColorStop(0,"rgba(90, 155, 255, 0.6)"),o.addColorStop(1,"rgba(90, 155, 255, 0)"),a.fillStyle=o,a.fillRect(r-30,i-30,60,60),a.fillStyle="#5a9bff",a.beginPath(),a.arc(r,i,8,0,Math.PI*2),a.fill(),a.strokeStyle="#ffffff",a.lineWidth=2,a.beginPath(),a.arc(r,i,12,0,Math.PI*2),a.stroke()}}async function Ke(a){if(M.isGenerating)return;const e=W.getBoundingClientRect();let t,n;if(a instanceof MouseEvent)t=a.clientX,n=a.clientY;else{const u=a.touches[0]||a.changedTouches[0];if(!u)return;t=u.clientX,n=u.clientY}const s=(t-e.left)/e.width*2-1,r=1-(n-e.top)/e.height*2,i=Math.max(-1,Math.min(1,s)),o=Math.max(-1,Math.min(1,r));M.currentPosition={percussiveMelodic:i,calmEnergetic:o};const l=U.getContext("2d");l&&St(l,e.width,e.height),await qs({percussiveMelodic:i,calmEnergetic:o})}async function qs(a){Fe(),M.isGenerating=!0,$(),T(`Generating music at (${a.percussiveMelodic.toFixed(1)}, ${a.calmEnergetic.toFixed(1)})...`);try{const t=await ks({twoAxisStyle:a,lengthInMeasures:16});M.composition=t,T(`Generated: ${t.meta.mood} at ${t.meta.bpm} BPM in ${t.meta.key}`),await Oe(),await Ae(t.events)}catch(e){const t=e instanceof Error?e.message:String(e);T(`Error: ${t}`),console.error("Generation failed:",e)}finally{M.isGenerating=!1,$()}}async function Oe(){P||(P=new AudioContext({sampleRate:44100,latencyHint:"interactive"})),P.state==="suspended"&&await P.resume(),K||(K=new at(P),await K.init()),N||(N=new at(P),await N.init()),!H&&N&&K&&(H=new Ls(P,N,()=>V,K.masterGain))}async function Ae(a,e=0){if(!P||!K)return;M.isPlaying=!0,E.disabled=!1,$();const n=P.currentTime+.2,s=Math.max(0,e);j.clear(),M.composition&&(V={startTime:n-s,loop:!0,meta:M.composition.meta}),K.play(a,{startTime:n,offset:s,loop:!0,onEvent:zs}).catch(r=>{console.error("Playback error:",r),M.isPlaying=!1,$()}),Ys(),X=0}function Fe(){K&&K.stop(),N&&N.stop(),H==null||H.cancelPendingJobs(),ie!==null&&(cancelAnimationFrame(ie),ie=null),M.isPlaying=!1,j.clear(),V=null,H==null||H.resetDucking(),Object.values(he).forEach(a=>{a.classList.remove("active"),a.style.opacity="0.3",a.style.boxShadow="none"}),$()}function Us(){P&&P.state==="running"&&P.suspend().catch(a=>{console.warn("AudioContext suspend failed:",a)})}function Vs(){var t,n;if(document.hidden){if(be=M.isPlaying,M.isPlaying&&P&&V){const s=Math.max(0,P.currentTime-V.startTime),r=((n=(t=V.meta)==null?void 0:t.loopInfo)==null?void 0:n.totalDuration)??0;X=r>0?s%r:s}else X=0;M.isPlaying&&(Fe(),T("Playback paused (tab inactive)")),Us();return}const a=be;be=!1;const e=async s=>{try{await Oe(),M.composition&&(await Ae(M.composition.events,s),T("Playback resumed"))}catch(r){console.error("Resuming playback failed:",r),T("Playback resume failed")}};if(a){const s=X;X=0,e(s)}else P&&P.state==="suspended"&&P.resume().catch(s=>{console.warn("AudioContext resume failed:",s)})}async function Ws(a){try{if(await Oe(),!H||!M.composition)return;const e=Mt[a],t=await Ds({type:e}),n=H.play(t,{duckingDb:-4,quantize:{quantizeTo:"beat",phase:"next",loopAware:!0}});T(`Scheduled ${e} sound effect`),n.catch(s=>{console.error("Indicator sound effect playback failed:",s),T("Sound effect playback failed")})}catch(e){console.error("Indicator sound effect trigger failed:",e),T("Sound effect trigger failed")}}function js(){Object.keys(Mt).forEach(a=>{const e=he[a];e&&(e.style.cursor="pointer",e.title="Hidden SE trigger",e.addEventListener("click",t=>{t.stopPropagation(),Ws(a)}))})}function $s(){M.isPlaying?(Fe(),T("Playback paused")):M.composition&&(Ae(M.composition.events),T("Playback resumed"))}function zs(a,e){var s,r;const t=a.channel,n=`${t}-${((s=a.data)==null?void 0:s.midi)||0}`;if(a.command==="noteOn"){const i=((r=a.data)==null?void 0:r.velocity)||64;j.set(n,{channel:t,velocity:typeof i=="number"?i:64,endTime:e+2})}else a.command==="noteOff"&&j.delete(n)}function Ys(){const a=()=>{if(!P||!M.isPlaying)return;const e=P.currentTime,t={square1:0,square2:0,triangle:0,noise:0};j.forEach((n,s)=>{if(e<=n.endTime){const r=n.channel;r in t&&(t[r]=Math.max(t[r],n.velocity))}else j.delete(s)}),M.channelActivity=t,Object.entries(t).forEach(([n,s])=>{const r=he[n];if(r){const i=s/127;s>0?(r.classList.add("active"),r.style.opacity=String(.5+i*.5),r.style.boxShadow=`0 0 ${20+i*30}px currentColor`):(r.classList.remove("active"),r.style.opacity="0.3",r.style.boxShadow="none")}}),ie=requestAnimationFrame(a)};a()}function $(){M.isGenerating?(E.disabled=!0,E.classList.add("loading"),ne.textContent=""):M.isPlaying?(E.disabled=!1,E.classList.remove("loading"),ne.textContent=" Pause",E.setAttribute("aria-label","Pause playback")):M.composition?(E.disabled=!1,E.classList.remove("loading"),ne.textContent=" Play",E.setAttribute("aria-label","Play playback")):(E.disabled=!0,E.classList.remove("loading"),ne.textContent="Play")}function T(a){Ns.textContent=a,Gs.textContent=a}W.addEventListener("click",a=>void Ke(a));W.addEventListener("touchstart",a=>{a.preventDefault(),Ke(a)});E.addEventListener("click",()=>$s());W.addEventListener("keydown",a=>{if(a.key==="Enter"||a.key===" "){a.preventDefault();const e=W.getBoundingClientRect(),t=e.left+e.width/2,n=e.top+e.height/2,s=new MouseEvent("click",{clientX:t,clientY:n});Ke(s)}});window.addEventListener("resize",()=>{bt()});document.addEventListener("visibilitychange",Vs);function Js(){Object.values(he).forEach(a=>{a.classList.remove("active"),a.style.opacity="0.3",a.style.boxShadow="none"})}bt();Js();js();$();
